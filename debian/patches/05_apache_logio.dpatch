#! /bin/sh /usr/share/dpatch/dpatch-run
## 05_apache_logio.dpatch by Jose Carlos Medeiros <debian@psabs.com.br>
##
## All lines beginning with `## DP:' are a description of the patch.
## DP: Added logio support for new apache2 mod_logio logfiles

# 05_apache_logio was downloaded from
# http://www.rexursive.com/software/apache.html
# ftp://ftp.rexursive.com/pub/webalizer/webalizer-in-out.patch.gz

@DPATCH@
diff -urNad webalizer-2.01.10~/README.FIRST webalizer-2.01.10/README.FIRST
--- webalizer-2.01.10~/README.FIRST	2006-05-24 19:05:11.000000000 -0300
+++ webalizer-2.01.10/README.FIRST	2006-05-24 19:06:52.000000000 -0300
@@ -358,3 +358,12 @@
 # The important part is to add --enable-geoip to the configure line.
 ##################

+###################  SUMMARY 05_apache_logio  ##########################
+
+##################
+# This Webalizer 2.01-10 patch intoduces necessary logic for presenting the
+# numbers collected by mod_logio in the reports. There are no special
+# configuration options required, just patch the Webalizer, configure it
+# with the options you prefer, build it, install it and use it.
+##################
+
diff -urNad webalizer-2.01.10~/graphs.c webalizer-2.01.10/graphs.c
--- webalizer-2.01.10~/graphs.c	2006-05-24 19:05:11.000000000 -0300
+++ webalizer-2.01.10/graphs.c	2006-05-24 19:05:11.000000000 -0300
@@ -92,12 +92,14 @@
                  u_int64_t data2[12],         /* data2 (files)      */
                  u_int64_t data3[12],         /* data3 (sites)      */
                  double data4[12],         /* data4 (kbytes)     */
-                 u_int64_t data5[12],         /* data5 (views)      */
-                 u_int64_t data6[12])         /* data6 (visits)     */
+                 double data5[12],         /* data5 (kbytes)     */
+                 double data6[12],         /* data6 (kbytes)     */
+                 u_int64_t data7[12],         /* data7 (views)      */
+                 u_int64_t data8[12])         /* data8 (visits)     */
 {

    /* local variables */
-   int i,j,x1,y1,x2;
+   int i,j,k,x1,y1,x2;
    int s_mth;

    u_int64_t maxval=1;
@@ -134,7 +136,7 @@
       if (s_mth > 12) s_mth = 1;
       if (data1[i] > maxval) maxval = data1[i];           /* get max val    */
       if (data2[i] > maxval) maxval = data2[i];
-      if (data5[i] > maxval) maxval = data5[i];
+      if (data7[i] > maxval) maxval = data7[i];
    }
    if (maxval <= 0) maxval = 1;
    sprintf(maxvaltxt, "%lld", maxval);
@@ -144,8 +146,18 @@
    {
       /* Kbytes Legend */
       i = (strlen(msg_h_xfer)*6);
-      gdImageString(im,gdFontSmall,491-i,239,msg_h_xfer,dkgrey);
-      gdImageString(im,gdFontSmall,490-i,238,msg_h_xfer,COLOR4);
+      j = (strlen(msg_h_ixfer)*6);
+      k = (strlen(msg_h_oxfer)*6);
+      gdImageString(im,gdFontSmall,491-i-j-k-24,239,msg_h_xfer,dkgrey);
+      gdImageString(im,gdFontSmall,490-i-j-k-24,238,msg_h_xfer,COLOR4);
+      gdImageString(im,gdFontSmall,491-k-j-21,239,"/",dkgrey);
+      gdImageString(im,gdFontSmall,490-k-j-21,238,"/",black);
+      gdImageString(im,gdFontSmall,491-k-j-12,239,msg_h_ixfer,dkgrey);
+      gdImageString(im,gdFontSmall,490-k-j-12,238,msg_h_ixfer,COLOR2);
+      gdImageString(im,gdFontSmall,491-k-9,239,"/",dkgrey);
+      gdImageString(im,gdFontSmall,490-k-9,238,"/",black);
+      gdImageString(im,gdFontSmall,491-k,239,msg_h_oxfer,dkgrey);
+      gdImageString(im,gdFontSmall,490-k,238,msg_h_oxfer,COLOR1);

       /* Sites/Visits Legend */
       i = (strlen(msg_h_visits)*6);
@@ -200,12 +212,12 @@
       gdImageRectangle(im, x1, y1, x2, 232, black);
    }

-   /* data5 */
+   /* data7 */
    s_mth = fmonth;
    for (i=0; i<12; i++)
    {
       if (s_mth > 12) s_mth = 1;
-      percent = ((float)data5[s_mth++ -1] / (float)maxval);
+      percent = ((float)data7[s_mth++ -1] / (float)maxval);
       if (percent <= 0.0) continue;
       x1 = 32 + (i*23);
       x2 = x1 + 13;
@@ -218,19 +230,19 @@
    for (i=0; i<12; i++)
    {
        if (data3[i] > maxval) maxval = data3[i];           /* get max val    */
-       if (data6[i] > maxval) maxval = data6[i];
+       if (data8[i] > maxval) maxval = data8[i];
    }
    if (maxval <= 0) maxval = 1;
    sprintf(maxvaltxt, "%lld", maxval);
    gdImageStringUp(im, gdFontSmall,493,26+(strlen(maxvaltxt)*6),
                    maxvaltxt, black);

-   /* data6 */
+   /* data8 */
    s_mth = fmonth;
    for (i=0; i<12; i++)
    {
       if (s_mth > 12) s_mth = 1;
-      percent = ((float)data6[s_mth++ -1] / (float)maxval);
+      percent = ((float)data8[s_mth++ -1] / (float)maxval);
       if (percent <= 0.0) continue;
       x1 = 310 + (i*15);
       x2 = x1 + 8;
@@ -254,8 +266,11 @@
    }

    fmaxval=0.0;
-   for (i=0; i<12; i++)
+   for (i=0; i<12; i++){
        if (data4[i] > fmaxval) fmaxval = data4[i];         /* get max val    */
+       if (data5[i] > fmaxval) fmaxval = data5[i];         /* get max val    */
+       if (data6[i] > fmaxval) fmaxval = data6[i];         /* get max val    */
+   }
    if (fmaxval <= 0.0) fmaxval = 1.0;
    sprintf(maxvaltxt, "%.0f", fmaxval);
    gdImageStringUp(im, gdFontSmall,493,130+(strlen(maxvaltxt)*6),
@@ -268,13 +283,41 @@
       if (s_mth > 12) s_mth = 1;
       percent = ((float)data4[s_mth++ -1] / (float)fmaxval);
       if (percent <= 0.0) continue;
-      x1 = 311 + (i*15);
-      x2 = x1 + 9;
+      x1 = 309 + (i*15);
+      x2 = x1 + 7;
       y1 = 232 - (percent * 98);
       gdImageFilledRectangle(im, x1, y1, x2, 232, COLOR4);
       gdImageRectangle(im, x1, y1, x2, 232, black);
    }

+   /* data5 */
+   s_mth = fmonth;
+   for (i=0; i<12; i++)
+   {
+      if (s_mth > 12) s_mth = 1;
+      percent = ((float)data5[s_mth++ -1] / (float)fmaxval);
+      if (percent <= 0.0) continue;
+      x1 = 311 + (i*15);
+      x2 = x1 + 7;
+      y1 = 232 - (percent * 98);
+      gdImageFilledRectangle(im, x1, y1, x2, 232, COLOR2);
+      gdImageRectangle(im, x1, y1, x2, 232, black);
+   }
+
+   /* data6 */
+   s_mth = fmonth;
+   for (i=0; i<12; i++)
+   {
+      if (s_mth > 12) s_mth = 1;
+      percent = ((float)data6[s_mth++ -1] / (float)fmaxval);
+      if (percent <= 0.0) continue;
+      x1 = 313 + (i*15);
+      x2 = x1 + 7;
+      y1 = 232 - (percent * 98);
+      gdImageFilledRectangle(im, x1, y1, x2, 232, COLOR1);
+      gdImageRectangle(im, x1, y1, x2, 232, black);
+   }
+
    /* save png image */
    if ((out = fopen(fname, "wb")) != NULL)
    {
@@ -303,8 +346,10 @@
                  u_int64_t data2[31],         /* data2 (files)      */
                  u_int64_t data3[31],         /* data3 (sites)      */
                  double data4[31],         /* data4 (kbytes)     */
-                 u_int64_t data5[31],         /* data5 (views)      */
-                 u_int64_t data6[31])         /* data6 (visits)     */
+                 double data5[31],         /* data5 (kbytes)     */
+                 double data6[31],         /* data6 (kbytes)     */
+                 u_int64_t data7[31],         /* data7 (views)      */
+                 u_int64_t data8[31])         /* data8 (visits)     */
 {

    /* local variables */
@@ -351,7 +396,7 @@
    {
        if (data1[i] > maxval) maxval = data1[i];           /* get max val    */
        if (data2[i] > maxval) maxval = data2[i];
-       if (data5[i] > maxval) maxval = data5[i];
+       if (data7[i] > maxval) maxval = data7[i];
    }
    if (maxval <= 0) maxval = 1;
    sprintf(maxvaltxt, "%lld", maxval);
@@ -361,17 +406,27 @@
    if (graph_legend)                           /* Print color coded legends? */
    {
       /* Kbytes Legend */
+      i=(strlen(msg_h_xfer)*6);
+      j=(strlen(msg_h_ixfer)*6);
       gdImageStringUp(im,gdFontSmall,494,376,msg_h_xfer,dkgrey);
       gdImageStringUp(im,gdFontSmall,493,375,msg_h_xfer,COLOR4);
+      gdImageStringUp(im,gdFontSmall,494,376-i-3,"/",dkgrey);
+      gdImageStringUp(im,gdFontSmall,493,375-i-3,"/",black);
+      gdImageStringUp(im,gdFontSmall,494,376-i-12,msg_h_ixfer,dkgrey);
+      gdImageStringUp(im,gdFontSmall,493,375-i-12,msg_h_ixfer,COLOR2);
+      gdImageStringUp(im,gdFontSmall,494,376-i-j-15,"/",dkgrey);
+      gdImageStringUp(im,gdFontSmall,493,375-i-j-15,"/",black);
+      gdImageStringUp(im,gdFontSmall,494,376-i-j-24,msg_h_oxfer,dkgrey);
+      gdImageStringUp(im,gdFontSmall,493,375-i-j-24,msg_h_oxfer,COLOR1);

       /* Sites/Visits Legend */
       i = (strlen(msg_h_sites)*6);
-      gdImageStringUp(im,gdFontSmall,494,276,msg_h_sites,dkgrey);
-      gdImageStringUp(im,gdFontSmall,493,275,msg_h_sites,COLOR3);
-      gdImageStringUp(im,gdFontSmall,494,276-i-3,"/",dkgrey);
-      gdImageStringUp(im,gdFontSmall,493,275-i-3,"/",black);
-      gdImageStringUp(im,gdFontSmall,494,276-i-12,msg_h_visits,dkgrey);
-      gdImageStringUp(im,gdFontSmall,493,275-i-12,msg_h_visits,COLOR6);
+      gdImageStringUp(im,gdFontSmall,494,256,msg_h_sites,dkgrey);
+      gdImageStringUp(im,gdFontSmall,493,255,msg_h_sites,COLOR3);
+      gdImageStringUp(im,gdFontSmall,494,256-i-3,"/",dkgrey);
+      gdImageStringUp(im,gdFontSmall,493,255-i-3,"/",black);
+      gdImageStringUp(im,gdFontSmall,494,256-i-12,msg_h_visits,dkgrey);
+      gdImageStringUp(im,gdFontSmall,493,255-i-12,msg_h_visits,COLOR6);

       /* Pages/Files/Hits Legend */
       s = ( i=(strlen(msg_h_pages)*6) )+
@@ -413,11 +468,11 @@
       gdImageRectangle(im, x1, y1, x2, 176, black);
    }

-   /* data5 */
+   /* data7 */
    for (i=0; i<31; i++)
    {
-      if (data5[i]==0) continue;
-      percent = ((float)data5[i] / (float)maxval);
+      if (data7[i]==0) continue;
+      percent = ((float)data7[i] / (float)maxval);
       if (percent <= 0.0) continue;
       x1 = 29 + (i*15);
       x2 = x1 + 7;
@@ -431,7 +486,7 @@
    for (i=0; i<31; i++)
    {
       if (data3[i]>maxval) maxval = data3[i];
-      if (data6[i]>maxval) maxval = data6[i];
+      if (data8[i]>maxval) maxval = data8[i];
    }
    if (maxval <= 0) maxval = 1;
    sprintf(maxvaltxt, "%lld", maxval);
@@ -441,7 +496,7 @@
    /* data 6 */
    for (i=0; i<31; i++)
    {
-      percent = ((float)data6[i] / (float)maxval);
+      percent = ((float)data8[i] / (float)maxval);
       if (percent <= 0.0) continue;
       x1 = 25 + (i*15);
       x2 = x1 + 8;
@@ -462,26 +517,53 @@
       gdImageRectangle(im, x1, y1, x2, 276, black);
    }

-   /* data4 */
    fmaxval=0.0;
-   for (i=0; i<31; i++)
+   for (i=0; i<31; i++){
       if (data4[i]>fmaxval) fmaxval = data4[i];
+      if (data5[i]>fmaxval) fmaxval = data5[i];
+      if (data6[i]>fmaxval) fmaxval = data6[i];
+   }
    if (fmaxval <= 0.0) fmaxval = 1.0;
    sprintf(maxvaltxt, "%.0f", fmaxval/1024);
    gdImageStringUp(im, gdFontSmall,8,280+(strlen(maxvaltxt)*6),
                    maxvaltxt, black);

+   /* data4 */
    for (i=0; i<31; i++)
    {
       percent = data4[i] / fmaxval;
       if (percent <= 0.0) continue;
-      x1 = 26 + (i*15);
-      x2 = x1 + 10;
+      x1 = 25 + (i*15);
+      x2 = x1 + 7;
       y1 = 375 - ( percent * 91 );
       gdImageFilledRectangle(im, x1, y1, x2, 375, COLOR4);
       gdImageRectangle(im, x1, y1, x2, 375, black);
    }

+   /* data5 */
+   for (i=0; i<31; i++)
+   {
+      percent = data5[i] / fmaxval;
+      if (percent <= 0.0) continue;
+      x1 = 27 + (i*15);
+      x2 = x1 + 7;
+      y1 = 375 - ( percent * 91 );
+      gdImageFilledRectangle(im, x1, y1, x2, 375, COLOR2);
+      gdImageRectangle(im, x1, y1, x2, 375, black);
+   }
+
+   /* data6 */
+   for (i=0; i<31; i++)
+   {
+      percent = data6[i] / fmaxval;
+      if (percent <= 0.0) continue;
+      x1 = 29 + (i*15);
+      x2 = x1 + 7;
+      y1 = 375 - ( percent * 91 );
+      gdImageFilledRectangle(im, x1, y1, x2, 375, COLOR1);
+      gdImageRectangle(im, x1, y1, x2, 375, black);
+   }
+
    /* open file for writing */
    if ((out = fopen(fname, "wb")) != NULL)
    {
diff -urNad webalizer-2.01.10~/graphs.h webalizer-2.01.10/graphs.h
--- webalizer-2.01.10~/graphs.h	2006-05-24 19:05:11.000000000 -0300
+++ webalizer-2.01.10/graphs.h	2006-05-24 19:05:11.000000000 -0300
@@ -2,9 +2,11 @@
 #define _GRAPHS_H

 extern int  month_graph6(char *, char *, int, int, u_int64_t *,
-             u_int64_t *, u_int64_t *, double *, u_int64_t *, u_int64_t *);
+             u_int64_t *, u_int64_t *, double *, double *, double *, u_int64_t *,
+             u_int64_t *);
 extern int  year_graph6x(char *, char *, int,
-             u_int64_t *, u_int64_t *, u_int64_t *, double *, u_int64_t *, u_int64_t *);
+             u_int64_t *, u_int64_t *, u_int64_t *, double *, double *, double *,
+             u_int64_t *, u_int64_t *);
 extern int  day_graph3(char *, char *, u_int64_t *, u_int64_t *, u_int64_t *);
 extern int  pie_chart(char *, char *, u_int64_t, u_int64_t *, char **);

diff -urNad webalizer-2.01.10~/hashtab.c webalizer-2.01.10/hashtab.c
--- webalizer-2.01.10~/hashtab.c	2006-05-24 19:05:11.000000000 -0300
+++ webalizer-2.01.10/hashtab.c	2006-05-24 19:05:11.000000000 -0300
@@ -157,6 +157,8 @@
                u_int64_t    count, /* hit count */
                u_int64_t    file,  /* File flag */
                double    xfer,  /* xfer size */
+               double    ixfer, /* in xfer size */
+               double    oxfer, /* out xfer size */
                u_int64_t   *ctr,   /* counter   */
                u_int64_t    visit, /* visits    */
                u_int64_t    tstamp,/* timestamp */
@@ -175,6 +177,8 @@
          nptr->count = count;
          nptr->files = file;
          nptr->xfer  = xfer;
+         nptr->ixfer = oxfer;
+         nptr->oxfer = oxfer;
          nptr->next  = NULL;
          htab[hash(str)] = nptr;
          if (type!=OBJ_GRP) (*ctr)++;
@@ -208,9 +212,11 @@
             if ((type==cptr->flag)||((type!=OBJ_GRP)&&(cptr->flag!=OBJ_GRP)))
             {
                /* found... bump counter */
-               cptr->count+=count;
-               cptr->files+=file;
-               cptr->xfer +=xfer;
+               cptr->count +=count;
+               cptr->files +=file;
+               cptr->xfer  +=xfer;
+               cptr->ixfer +=ixfer;
+               cptr->oxfer +=oxfer;

                if (ispage(log_rec.url))
                {
@@ -238,6 +244,8 @@
          nptr->count = count;
          nptr->files = file;
          nptr->xfer  = xfer;
+         nptr->ixfer = oxfer;
+         nptr->oxfer = oxfer;
          nptr->next  = htab[hash(str)];
          htab[hash(str)]=nptr;
          if (type!=OBJ_GRP) (*ctr)++;
@@ -342,6 +350,7 @@
 /*********************************************/

 int put_unode(char *str, int type, u_int64_t count, double xfer,
+              double ixfer, double oxfer,
               u_int64_t *ctr, u_int64_t entry, u_int64_t exit, UNODEPTR *htab)
 {
    UNODEPTR cptr,nptr;
@@ -354,12 +363,14 @@
       /* not hashed */
       if ( (nptr=new_unode(str)) != NULL)
       {
-         nptr->flag = type;
-         nptr->count= count;
-         nptr->xfer = xfer;
-         nptr->next = NULL;
-         nptr->entry= entry;
-         nptr->exit = exit;
+         nptr->flag  = type;
+         nptr->count = count;
+         nptr->xfer  = xfer;
+         nptr->ixfer = ixfer;
+         nptr->oxfer = oxfer;
+         nptr->next  = NULL;
+         nptr->entry = entry;
+         nptr->exit  = exit;
          htab[hash(str)] = nptr;
          if (type!=OBJ_GRP) (*ctr)++;
       }
@@ -374,8 +385,10 @@
             if ((type==cptr->flag)||((type!=OBJ_GRP)&&(cptr->flag!=OBJ_GRP)))
             {
                /* found... bump counter */
-               cptr->count+=count;
-               cptr->xfer += xfer;
+               cptr->count +=count;
+               cptr->xfer  += xfer;
+               cptr->ixfer += ixfer;
+               cptr->oxfer += oxfer;
                return 0;
             }
          }
@@ -384,12 +397,14 @@
       /* not found... */
       if ( (nptr = new_unode(str)) != NULL)
       {
-         nptr->flag = type;
-         nptr->count= count;
-         nptr->xfer = xfer;
-         nptr->next = htab[hash(str)];
-         nptr->entry= entry;
-         nptr->exit = exit;
+         nptr->flag  = type;
+         nptr->count = count;
+         nptr->xfer  = xfer;
+         nptr->ixfer = ixfer;
+         nptr->oxfer = oxfer;
+         nptr->next  = htab[hash(str)];
+         nptr->entry = entry;
+         nptr->exit  = exit;
          htab[hash(str)]=nptr;
          if (type!=OBJ_GRP) (*ctr)++;
       }
@@ -813,6 +828,8 @@
                u_int64_t    count, /* hit count */
                u_int64_t    file,  /* File flag */
                double    xfer,  /* xfer size */
+               double    ixfer, /* in xfer size */
+               double    oxfer, /* out xfer size */
                u_int64_t   *ctr,   /* counter   */
                u_int64_t    visit, /* visits    */
                u_int64_t    tstamp,/* timestamp */
@@ -832,6 +849,8 @@
          nptr->count = count;
          nptr->files = file;
          nptr->xfer  = xfer;
+         nptr->ixfer = ixfer;
+         nptr->oxfer = oxfer;
          nptr->next  = NULL;
          htab[hash(str)] = nptr;
          if (type!=OBJ_GRP) (*ctr)++;
@@ -858,9 +877,11 @@
             if ((type==cptr->flag)||((type!=OBJ_GRP)&&(cptr->flag!=OBJ_GRP)))
             {
                /* found... bump counter */
-               cptr->count+=count;
-               cptr->files+=file;
-               cptr->xfer +=xfer;
+               cptr->count +=count;
+               cptr->files +=file;
+               cptr->xfer  +=xfer;
+               cptr->ixfer +=ixfer;
+               cptr->oxfer +=oxfer;

                if (ispage(log_rec.url))
                {
@@ -880,6 +901,8 @@
          nptr->count = count;
          nptr->files = file;
          nptr->xfer  = xfer;
+         nptr->ixfer = ixfer;
+         nptr->oxfer = oxfer;
          nptr->next  = htab[hash(str)];
          htab[hash(str)]=nptr;
          if (type!=OBJ_GRP) (*ctr)++;
diff -urNad webalizer-2.01.10~/hashtab.h webalizer-2.01.10/hashtab.h
--- webalizer-2.01.10~/hashtab.h	2006-05-24 19:05:11.000000000 -0300
+++ webalizer-2.01.10/hashtab.h	2006-05-24 19:05:11.000000000 -0300
@@ -31,6 +31,8 @@
               u_int64_t tstamp;
                 char *lasturl;
               double xfer;
+              double ixfer;
+              double oxfer;
               struct hnode *next; };

 struct unode {  char *string;              /* url hash table structure     */
@@ -40,6 +42,8 @@
               u_int64_t entry;                /* entry page counter           */
               u_int64_t exit;                 /* exit page counter            */
               double xfer;                 /* xfer size in bytes           */
+              double ixfer;                /* in xfer size in bytes        */
+              double oxfer;                /* out xfer size in bytes       */
               struct unode *next; };       /* pointer to next node         */

 struct rnode {  char *string;              /* referrer hash table struct   */
@@ -63,6 +67,8 @@
               u_int64_t visit;
               u_int64_t tstamp;
               double xfer;
+              double ixfer;
+              double oxfer;
               struct inode *next; };

 extern HNODEPTR sm_htab[MAXHASH];             /* hash tables               */
@@ -76,12 +82,12 @@
 extern DNODEPTR host_table[MAXHASH];          /* DNS resolver table        */
 #endif

-extern int    put_hnode(char *, int, u_int64_t, u_int64_t, double, u_int64_t *,
-                        u_int64_t, u_int64_t, char *, HNODEPTR *);
-extern int    put_unode(char *, int, u_int64_t, double, u_int64_t *,
+extern int    put_hnode(char *, int, u_int64_t, u_int64_t, double, double, double,
+                        u_int64_t *, u_int64_t, u_int64_t, char *, HNODEPTR *);
+extern int    put_unode(char *, int, u_int64_t, double, double, double, u_int64_t *,
                         u_int64_t, u_int64_t, UNODEPTR *);
-extern int    put_inode(char *, int, u_int64_t, u_int64_t, double, u_int64_t *,
-                        u_int64_t, u_int64_t, INODEPTR *);
+extern int    put_inode(char *, int, u_int64_t, u_int64_t, double, double, double,
+                        u_int64_t *, u_int64_t, u_int64_t, INODEPTR *);
 extern int    put_rnode(char *, int, u_int64_t, u_int64_t *, RNODEPTR *);
 extern int    put_anode(char *, int, u_int64_t, u_int64_t *, ANODEPTR *);
 extern int    put_snode(char *, u_int64_t, SNODEPTR *);
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.catalan webalizer-2.01.10/lang/webalizer_lang.catalan
--- webalizer-2.01.10~/lang/webalizer_lang.catalan	2000-10-18 23:43:45.000000000 -0200
+++ webalizer-2.01.10/lang/webalizer_lang.catalan	2006-05-24 19:05:11.000000000 -0300
@@ -198,7 +198,9 @@
 char *msg_h_visits= "Visites";
 char *msg_h_files = "Fitxers";
 char *msg_h_sites = "Navegadors";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Visitant";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Navegador";
@@ -224,7 +226,9 @@
 char *msg_mtot_ms = "Estad&iacute;stiques mensuals";
 char *msg_mtot_th = "Total d'Accessos";
 char *msg_mtot_tf = "Total de Fitxers";
-char *msg_mtot_tx = "Total de Kbytes";
+char *msg_mtot_tx = "Total de kB Fitxers";
+char *msg_mtot_ix = "Total de kB In";
+char *msg_mtot_ox = "Total de kB Out";
 char *msg_mtot_us = "Total de Servidors";
 char *msg_mtot_ur = "Total d' Enlla&ccedil;os d'Origen";
 char *msg_mtot_ua = "Total de Navegadors";
@@ -235,7 +239,9 @@
 char *msg_mtot_mfd= "Fitxers per dia";
 char *msg_mtot_mpd= "Planes per dia";
 char *msg_mtot_mvd= "Visites per dia";
-char *msg_mtot_mkd= "KBytes per dia";
+char *msg_mtot_mkd= "kB Fitxers per dia";
+char *msg_mtot_ikd= "kB In per dia";
+char *msg_mtot_okd= "kB Out per dia";
 char *msg_mtot_rc = "Accesos segons codi de resposta";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.chinese webalizer-2.01.10/lang/webalizer_lang.chinese
--- webalizer-2.01.10~/lang/webalizer_lang.chinese	2000-10-06 02:27:48.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.chinese	2006-05-24 19:05:11.000000000 -0300
@@ -192,7 +192,9 @@
 char *msg_h_visits= "Visits";
 char *msg_h_files = "ÀÉ®×";
 char *msg_h_sites = "ºô¯¸¼Æ";
-char *msg_h_xfer  = "¶Ç°e¶q¡]KB¡^";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "¥D¾÷¦WºÙ";
 char *msg_h_url   = "ºô­¶¸ô®|";
 char *msg_h_agent = "ÂsÄý¾¹";
@@ -219,6 +221,8 @@
 char *msg_mtot_th = "Á`Åª¨ú¼Æ";
 char *msg_mtot_tf = "Á`ÀÉ®×¼Æ";
 char *msg_mtot_tx = "Á`¶Ç°e¶q¡]KB¡^";
+char *msg_mtot_ix = "Total kB In";
+char *msg_mtot_ox = "Total kB Out";
 char *msg_mtot_us = "¨Ó·½ºô¯¸Á`¼Æ¡]¤£¥]§t­«ÂÐªÌ¡^";
 char *msg_mtot_ur = "¨Ó·½ºô­¶Á`¼Æ¡]¤£¥]§t­«ÂÐªÌ¡^";
 char *msg_mtot_ua = "¨Ó·½ÂsÄý¾¹Á`¼Æ¡]¤£¥]§t­«ÂÐªÌ¡^";
@@ -229,7 +233,9 @@
 char *msg_mtot_mfd= "Files per Day";
 char *msg_mtot_mpd= "Pages per Day";
 char *msg_mtot_mvd= "Visits per Day";
-char *msg_mtot_mkd= "KBytes per Day";
+char *msg_mtot_mkd= "kB Files per Day";
+char *msg_mtot_ikd= "kB In per Day";
+char *msg_mtot_okd= "kB Out per Day";
 char *msg_mtot_rc = "ºô­¶Åª¨ú®É¤§¦^À³¥N½X";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.croatian webalizer-2.01.10/lang/webalizer_lang.croatian
--- webalizer-2.01.10~/lang/webalizer_lang.croatian	2001-06-15 05:02:48.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.croatian	2006-05-24 19:05:11.000000000 -0300
@@ -189,7 +189,9 @@
 char *msg_h_visits= "Posjeta";
 char *msg_h_files = "Datoteka";
 char *msg_h_sites = "Kompjutera";
-char *msg_h_xfer  = "KB";
+char *msg_h_xfer  = "kB D";
+char *msg_h_ixfer = "kB U";
+char *msg_h_oxfer = "kB Van";
 char *msg_h_hname = "Kompjuter";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Korisnicki program";
@@ -215,7 +217,9 @@
 char *msg_mtot_ms = "Mjesecna statistika za";
 char *msg_mtot_th = "Ukupno pristupa";
 char *msg_mtot_tf = "Ukupno datoteka";
-char *msg_mtot_tx = "Ukupno KBajta";
+char *msg_mtot_tx = "Ukupno kB datoteka";
+char *msg_mtot_ix = "Ukupno kB unutra";
+char *msg_mtot_ox = "Ukupno kB van";
 char *msg_mtot_us = "Ukupno razlicitih kompjutera";
 char *msg_mtot_ur = "Ukupno razlicitih referiranja";
 char *msg_mtot_ua = "Ukupno razlicitih browsera";
@@ -226,7 +230,9 @@
 char *msg_mtot_mfd= "Datoteka na dan";
 char *msg_mtot_mpd= "Datoteka na sat";
 char *msg_mtot_mvd= "Posjeta na dan";
-char *msg_mtot_mkd= "KBajta na dan";
+char *msg_mtot_mkd= "kB Datatoka na dan";
+char *msg_mtot_ikd= "kB Unutra na dan";
+char *msg_mtot_okd= "kB Van na dan";
 char *msg_mtot_rc = "Pristupa po kodu";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.czech webalizer-2.01.10/lang/webalizer_lang.czech
--- webalizer-2.01.10~/lang/webalizer_lang.czech	2002-04-16 18:36:54.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.czech	2006-05-24 19:05:11.000000000 -0300
@@ -197,7 +197,9 @@
 char *msg_h_visits= "Náv¹tìv";
 char *msg_h_files = "Souborù";
 char *msg_h_sites = "Míst";
-char *msg_h_xfer  = "KBytù";
+char *msg_h_xfer  = "kB S";
+char *msg_h_oxfer = "kB In";
+char *msg_h_ixfer = "kB Out";
 char *msg_h_hname = "Poèítaè";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Prohlí¾eè";
@@ -223,7 +225,9 @@
 char *msg_mtot_ms = "Mìsíèní statistiky za";
 char *msg_mtot_th = "Celkem náv¹tìv";
 char *msg_mtot_tf = "Celkem souborù";
-char *msg_mtot_tx = "Celkem KBytù";
+char *msg_mtot_tx = "Celkem kB souborù";
+char *msg_mtot_ix = "Celkem kB In";
+char *msg_mtot_ox = "Celkem kB Out";
 char *msg_mtot_us = "Celkem jedineèných míst";
 char *msg_mtot_ur = "Celkem jedineèných odkazovaèù";
 char *msg_mtot_ua = "Celkem jedineèných Prohlí¾eèù";
@@ -234,7 +238,9 @@
 char *msg_mtot_mfd= "Souborù za den";
 char *msg_mtot_mpd= "Stránek za den";
 char *msg_mtot_mvd= "Náv¹tìv za den";
-char *msg_mtot_mkd= "KBytú za den";
+char *msg_mtot_mkd= "kB souborù za den";
+char *msg_mtot_ikd= "kB In za den";
+char *msg_mtot_okd= "kB Out za den";
 char *msg_mtot_rc = "Náv¹tìvy podle kódu odpovìdi";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.danish webalizer-2.01.10/lang/webalizer_lang.danish
--- webalizer-2.01.10~/lang/webalizer_lang.danish	2000-10-06 02:27:48.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.danish	2006-05-24 19:05:11.000000000 -0300
@@ -192,7 +192,9 @@
 char *msg_h_visits= "Besøg";
 char *msg_h_files = "Filer";
 char *msg_h_sites = "Gæster";
-char *msg_h_xfer  = "kB";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Navn/IP-adresse";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Browser";
@@ -218,7 +220,9 @@
 char *msg_mtot_ms = "Månedlig statistik for";
 char *msg_mtot_th = "Forespørgsler";
 char *msg_mtot_tf = "Filer";
-char *msg_mtot_tx = "kB";
+char *msg_mtot_tx = "kB Filer";
+char *msg_mtot_ix = "kB In";
+char *msg_mtot_ox = "kB Out";
 char *msg_mtot_us = "Unikke gæster";
 char *msg_mtot_ur = "Unikke henvisende sider";
 char *msg_mtot_ua = "Unikke browsere";
@@ -229,7 +233,9 @@
 char *msg_mtot_mfd= "Filer pr. dag";
 char *msg_mtot_mpd= "Sider pr. dag";
 char *msg_mtot_mvd= "Besøg pr. dag";
-char *msg_mtot_mkd= "kB pr. dag";
+char *msg_mtot_mkd= "kB Filer pr. dag";
+char *msg_mtot_ikd= "kB Out pr. dag";
+char *msg_mtot_okd= "kB In pr. dag";
 char *msg_mtot_rc = "Forespørgsler fordelt på svarkoder";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.dutch webalizer-2.01.10/lang/webalizer_lang.dutch
--- webalizer-2.01.10~/lang/webalizer_lang.dutch	2000-10-06 02:27:48.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.dutch	2006-05-24 19:05:11.000000000 -0300
@@ -210,7 +210,9 @@
 char *msg_h_visits= "Bezoeken";
 char *msg_h_files = "Bestanden";
 char *msg_h_sites = "Hosts";
-char *msg_h_xfer  = "kB"; /* afgekort i.v.m. onderschrift grafiek */
+char *msg_h_xfer  = "kB B"; /* afgekort i.v.m. onderschrift grafiek */
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Host(naam)";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Browser";
@@ -236,7 +238,9 @@
 char *msg_mtot_ms = "Maandoverzicht -";
 char *msg_mtot_th = "Totaal hits";
 char *msg_mtot_tf = "Totaal bestanden";
-char *msg_mtot_tx = "Totaal kilobytes";
+char *msg_mtot_tx = "Totaal kB bestanden";
+char *msg_mtot_ix = "Totaal kB In";
+char *msg_mtot_ox = "Totaal kB Out";
 char *msg_mtot_us = "Totaal verschillende hosts";
 char *msg_mtot_ur = "Totaal verschillende verwijzers";
 char *msg_mtot_ua = "Totaal verschillende browsers";
@@ -247,7 +251,9 @@
 char *msg_mtot_mfd= "Bestanden per dag";
 char *msg_mtot_mpd= "Pagina's per dag";
 char *msg_mtot_mvd= "Bezoeken per dag";
-char *msg_mtot_mkd= "Kilobytes per dag";
+char *msg_mtot_mkd= "kB Bestanden per dag";
+char *msg_mtot_ikd= "kB In per dag";
+char *msg_mtot_okd= "kB Out per dag";
 char *msg_mtot_rc = "Hits per 'Response Code'";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.english webalizer-2.01.10/lang/webalizer_lang.english
--- webalizer-2.01.10~/lang/webalizer_lang.english	2006-05-24 19:05:11.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.english	2006-05-24 19:05:11.000000000 -0300
@@ -196,7 +196,9 @@
 char *msg_h_visits= "Visits";
 char *msg_h_files = "Files";
 char *msg_h_sites = "Sites";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Hostname";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "User Agent";
@@ -222,7 +224,9 @@
 char *msg_mtot_ms = "Monthly Statistics for";
 char *msg_mtot_th = "Total Hits";
 char *msg_mtot_tf = "Total Files";
-char *msg_mtot_tx = "Total KBytes";
+char *msg_mtot_tx = "Total kB Files";
+char *msg_mtot_ix = "Total kB In";
+char *msg_mtot_ox = "Total kB Out";
 char *msg_mtot_us = "Total Unique Sites";
 char *msg_mtot_ur = "Total Unique Referrers";
 char *msg_mtot_ua = "Total Unique User Agents";
@@ -233,7 +237,9 @@
 char *msg_mtot_mfd= "Files per Day";
 char *msg_mtot_mpd= "Pages per Day";
 char *msg_mtot_mvd= "Visits per Day";
-char *msg_mtot_mkd= "KBytes per Day";
+char *msg_mtot_mkd= "kB Files per Day";
+char *msg_mtot_ikd= "kB In per Day";
+char *msg_mtot_okd= "kB Out per Day";
 char *msg_mtot_rc = "Hits by Response Code";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.estonian webalizer-2.01.10/lang/webalizer_lang.estonian
--- webalizer-2.01.10~/lang/webalizer_lang.estonian	2001-07-04 18:21:38.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.estonian	2006-05-24 19:05:11.000000000 -0300
@@ -180,7 +180,9 @@
 char *msg_h_visits= "Külastusi";
 char *msg_h_files = "Faile";
 char *msg_h_sites = "Arvuteid";
-char *msg_h_xfer  = "KBaite";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Server";
 char *msg_h_url   = "Aadress";
 char *msg_h_agent = "Lehitseja";
@@ -206,7 +208,9 @@
 char *msg_mtot_ms = "Kuu statistika";
 char *msg_mtot_th = "Kokku Pöördumisi";
 char *msg_mtot_tf = "Kokku Faile";
-char *msg_mtot_tx = "Kokku KBaite";
+char *msg_mtot_tx = "Kokku kB Faile";
+char *msg_mtot_ix = "Kokku kB In";
+char *msg_mtot_ox = "Kokku kB Out";
 char *msg_mtot_us = "Kokku Erinevaid Kasutajaid";
 char *msg_mtot_ur = "Kokku Erinevaid Viitajaid";
 char *msg_mtot_ua = "Kokku Erinevaid Lehitsejaid";
@@ -217,7 +221,9 @@
 char *msg_mtot_mfd= "Faile Päevas";
 char *msg_mtot_mpd= "Lehekülgi Päevas";
 char *msg_mtot_mvd= "Visiite Päevas";
-char *msg_mtot_mkd= "KBaite Päevas";
+char *msg_mtot_mkd= "kB Faile Päevas";
+char *msg_mtot_ikd= "kB In Päevas";
+char *msg_mtot_okd= "kB Out Päevas";
 char *msg_mtot_rc = "Pöördumisi vastusetüüpide kaupa";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.finnish webalizer-2.01.10/lang/webalizer_lang.finnish
--- webalizer-2.01.10~/lang/webalizer_lang.finnish	2001-02-10 00:26:29.000000000 -0200
+++ webalizer-2.01.10/lang/webalizer_lang.finnish	2006-05-24 19:05:11.000000000 -0300
@@ -199,7 +199,9 @@
 char *msg_h_visits= "vierailuja";
 char *msg_h_files = "tiedostoja";
 char *msg_h_sites = "koneita";
-char *msg_h_xfer  = "kilotavuja";
+char *msg_h_xfer  = "kB T";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Välityspalvelin";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Käytetyt selaimet";
@@ -225,7 +227,9 @@
 char *msg_mtot_ms = "Kuukausitilastot";
 char *msg_mtot_th = "Osumia yhteensä";
 char *msg_mtot_tf = "Tiedostoja yhteensä";
-char *msg_mtot_tx = "Kilotavuja yhteensä";
+char *msg_mtot_tx = "kB Tiedostoja yhteensä";
+char *msg_mtot_ix = "kB In yhteensä";
+char *msg_mtot_ox = "kB Out yhteensä";
 char *msg_mtot_us = "Yhteensä erilaisia koneita";
 char *msg_mtot_ur = "Yhteensä erilaisia hakupalvelimia";
 char *msg_mtot_ua = "Yhteensä erilaisia selaimia";
@@ -236,7 +240,9 @@
 char *msg_mtot_mfd= "Tiedostoja / päivä";
 char *msg_mtot_mpd= "Sivuja / päivä";
 char *msg_mtot_mvd= "Vierailuja / päivä";
-char *msg_mtot_mkd= "Kilotavuja / päivä";
+char *msg_mtot_mkd= "kB Tiedostoja / päivä";
+char *msg_mtot_ikd= "kB In / päivä";
+char *msg_mtot_okd= "kB Out / päivä";
 char *msg_mtot_rc = "Osumien vastauskoodit";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.french webalizer-2.01.10/lang/webalizer_lang.french
--- webalizer-2.01.10~/lang/webalizer_lang.french	2000-10-06 02:27:48.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.french	2006-05-24 19:05:11.000000000 -0300
@@ -228,7 +228,9 @@
 char *msg_h_visits= "Visites";
 char *msg_h_files = "Fichiers";
 char *msg_h_sites = "Sites";
-char *msg_h_xfer  = "Ko";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Nom d'h&ocirc;te";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Navigateur";
@@ -254,7 +256,9 @@
 char *msg_mtot_ms = "Statistiques mensuelles pour";
 char *msg_mtot_th = "Total des Hits";
 char *msg_mtot_tf = "Total des Fichiers";
-char *msg_mtot_tx = "Total des Ko";
+char *msg_mtot_tx = "Total des kB Fichiers";
+char *msg_mtot_ix = "Total des kB In";
+char *msg_mtot_ox = "Total des kB Out";
 char *msg_mtot_us = "Total des Sites uniques";
 char *msg_mtot_ur = "Total des R&eacute;f&eacute;rents uniques";
 char *msg_mtot_ua = "Total des Navigateurs";
@@ -265,7 +269,9 @@
 char *msg_mtot_mfd= "Fichiers par Jour";
 char *msg_mtot_mpd= "Pages par Jour";
 char *msg_mtot_mvd= "Visites par Jour";
-char *msg_mtot_mkd= "KOctets par Jour";
+char *msg_mtot_mkd= "kB Fichiers par Jour";
+char *msg_mtot_ikd= "kB In par Jour";
+char *msg_mtot_okd= "kB Out par Jour";
 char *msg_mtot_rc = "Hits par code de r&eacute;ponse";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.galician webalizer-2.01.10/lang/webalizer_lang.galician
--- webalizer-2.01.10~/lang/webalizer_lang.galician	2001-06-15 05:02:48.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.galician	2006-05-24 19:05:11.000000000 -0300
@@ -198,7 +198,9 @@
 char *msg_h_visits= "Visitas";
 char *msg_h_files = "Arquivos";
 char *msg_h_sites = "Clientes";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "kB A";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Máquina";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Programa cliente";
@@ -224,7 +226,9 @@
 char *msg_mtot_ms = "Estatísticas mensuais de";
 char *msg_mtot_th = "Total Accesos";
 char *msg_mtot_tf = "Total Arquivos";
-char *msg_mtot_tx = "Total KBytes";
+char *msg_mtot_tx = "Total kB Arquivos";
+char *msg_mtot_ix = "Total kB In";
+char *msg_mtot_ox = "Total kB Out";
 char *msg_mtot_us = "Total Clientes";
 char *msg_mtot_ur = "Total Ligazóns orixe";
 char *msg_mtot_ua = "Total Programas visores";
@@ -235,7 +239,9 @@
 char *msg_mtot_mfd= "Arquivos por Día";
 char *msg_mtot_mpd= " Páxinas por Día";
 char *msg_mtot_mvd= "Visitas por Día";
-char *msg_mtot_mkd= "KBytes por Día";
+char *msg_mtot_mkd= "kB Arquivos por Día";
+char *msg_mtot_ikd= "kB In por Día";
+char *msg_mtot_okd= "kB Out por Día";
 char *msg_mtot_rc = "Accesos por código de resposta";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.german webalizer-2.01.10/lang/webalizer_lang.german
--- webalizer-2.01.10~/lang/webalizer_lang.german	2000-10-06 02:27:48.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.german	2006-05-24 19:05:11.000000000 -0300
@@ -215,7 +215,9 @@
 char *msg_h_visits= "Besuche";
 char *msg_h_files = "Dateien";
 char *msg_h_sites = "Rechner";
-char *msg_h_xfer  = "kb";
+char *msg_h_xfer  = "kB D";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Rechnername";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Anwenderprogramm";
@@ -241,7 +243,9 @@
 char *msg_mtot_ms = "Monats-Statistik f&uuml;r";
 char *msg_mtot_th = "Summe Anfragen";
 char *msg_mtot_tf = "Summe Dateien";
-char *msg_mtot_tx = "Summe kb";
+char *msg_mtot_tx = "Summe kB Dateien";
+char *msg_mtot_ix = "Summe kB In";
+char *msg_mtot_ox = "Summe kB Out";
 char *msg_mtot_us = "Summe unterschiedlicher Rechner (IP-Adressen)";
 char *msg_mtot_ur = "Summe unterschiedlicher Verweise";
 char *msg_mtot_ua = "Summe unterschiedlicher Anwenderprogramme";
@@ -252,7 +256,9 @@
 char *msg_mtot_mfd= "Dateien pro Tag";
 char *msg_mtot_mpd= "Seiten pro Tag";
 char *msg_mtot_mvd= "Besuche pro Tag";
-char *msg_mtot_mkd= "kb pro Tag";
+char *msg_mtot_mkd= "kB Dateien pro Tag";
+char *msg_mtot_ikd= "kB In pro Tag";
+char *msg_mtot_okd= "kB Out pro Tag";
 char *msg_mtot_rc = "Anfragen nach Status-Code";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.greek webalizer-2.01.10/lang/webalizer_lang.greek
--- webalizer-2.01.10~/lang/webalizer_lang.greek	2000-10-06 02:27:48.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.greek	2006-05-24 19:05:11.000000000 -0300
@@ -192,7 +192,9 @@
 char *msg_h_visits= "ÅðéóêÝøåéò";
 char *msg_h_files = "Áñ÷åßá";
 char *msg_h_sites = "ÓõóôÞìáôá";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Óýóôçìá";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Ðñüãñáììá";
@@ -218,7 +220,9 @@
 char *msg_mtot_ms = "ÓõãêåíôñùôéêÜ óôïé÷åßá ãéá ôï ìÞíá";
 char *msg_mtot_th = "ÓõíïëéêÜ Hits";
 char *msg_mtot_tf = "Óýíïëï áñ÷åßùí";
-char *msg_mtot_tx = "Óýíïëï KBytes";
+char *msg_mtot_tx = "Óýíïëï kB áñ÷åßùí";
+char *msg_mtot_ix = "Óýíïëï kB In";
+char *msg_mtot_ox = "Óýíïëï kB Out";
 char *msg_mtot_us = "Óýíïëï äéáöïñåôéêþí óõóôçìÜôùí";
 char *msg_mtot_ur = "Óýíïëï äéáöïñåôéêþí áíáöåñüíôùí";
 char *msg_mtot_ua = "Óýíïëï äéáöïñåôéêþí ðñïãñáììÜôùí";
@@ -229,7 +233,9 @@
 char *msg_mtot_mfd= "Áñ÷åßá áíÜ çìÝñá";
 char *msg_mtot_mpd= "Óåëßäåò áíÜ çìÝñá";
 char *msg_mtot_mvd= "ÅðéóêÝøåéò áíÜ çìÝñá";
-char *msg_mtot_mkd= "KBytes áíÜ çìÝñá";
+char *msg_mtot_mkd= "kB Áñ÷åßá áíÜ çìÝñá";
+char *msg_mtot_ikd= "kB In áíÜ çìÝñá";
+char *msg_mtot_okd= "kB Out áíÜ çìÝñá";
 char *msg_mtot_rc = "Hits áðü ôï áðïôÝëåóìá";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.hungarian webalizer-2.01.10/lang/webalizer_lang.hungarian
--- webalizer-2.01.10~/lang/webalizer_lang.hungarian	2000-10-06 02:27:48.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.hungarian	2006-05-24 19:05:11.000000000 -0300
@@ -198,7 +198,9 @@
 char *msg_h_visits= "Látogatók";
 char *msg_h_files = "File-ok";
 char *msg_h_sites = "Oldalak";
-char *msg_h_xfer  = "KByte";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Hostnév";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Felhasználó böngészõje";
@@ -224,7 +226,9 @@
 char *msg_mtot_ms = "Havi Statisztika:";
 char *msg_mtot_th = "Összes Találat";
 char *msg_mtot_tf = "Összes File";
-char *msg_mtot_tx = "Összes KByte";
+char *msg_mtot_tx = "Összes kB File";
+char *msg_mtot_ix = "Összes kB In";
+char *msg_mtot_ox = "Összes kB Out";
 char *msg_mtot_us = "Összes különbözõ Oldal";
 char *msg_mtot_ur = "Összes különbözõ Hivatkozás";
 char *msg_mtot_ua = "Összes különbözõ Felhasználó böngészõje";
@@ -235,7 +239,9 @@
 char *msg_mtot_mfd= "File/nap";
 char *msg_mtot_mpd= "Lap/nap";
 char *msg_mtot_mvd= "Látogató/nap";
-char *msg_mtot_mkd= "KByte/nap";
+char *msg_mtot_mkd= "kB File/nap";
+char *msg_mtot_ikd= "kB In/nap";
+char *msg_mtot_okd= "kB Out/nap";
 char *msg_mtot_rc = "Válaszkódok általi találatok";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.icelandic webalizer-2.01.10/lang/webalizer_lang.icelandic
--- webalizer-2.01.10~/lang/webalizer_lang.icelandic	2000-12-17 02:49:25.000000000 -0200
+++ webalizer-2.01.10/lang/webalizer_lang.icelandic	2006-05-24 19:05:11.000000000 -0300
@@ -200,7 +200,9 @@
 char *msg_h_visits= "Heimsóknir";
 char *msg_h_files = "Skrár";
 char *msg_h_sites = "Sites";
-char *msg_h_xfer  = "KBæti";
+char *msg_h_xfer  = "kB S";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Host nafn";
 char *msg_h_url   = "Slóð";
 char *msg_h_agent = "User Agent";
@@ -226,7 +228,9 @@
 char *msg_mtot_ms = "Mánaðar Samtölur fyrir";
 char *msg_mtot_th = "Samtals Beiðnir";
 char *msg_mtot_tf = "Samtals Skrár";
-char *msg_mtot_tx = "Samtals KBæti";
+char *msg_mtot_tx = "Samtals kB Skrár";
+char *msg_mtot_ix = "Samtals kB In";
+char *msg_mtot_ox = "Samtals kB Out";
 char *msg_mtot_us = "Samtals Einstakar Síður";
 char *msg_mtot_ur = "Samtals Unique Referrers";
 char *msg_mtot_ua = "Samtals Unique User Agents";
@@ -237,7 +241,9 @@
 char *msg_mtot_mfd= "Skrár á Dag";
 char *msg_mtot_mpd= "Síður á Dag";
 char *msg_mtot_mvd= "Heimsóknir á Dag";
-char *msg_mtot_mkd= "KBæti á Dag";
+char *msg_mtot_mkd= "kB Skrár á Dag";
+char *msg_mtot_ikd= "kB In á Dag";
+char *msg_mtot_okd= "kB Out á Dag";
 char *msg_mtot_rc = "Hits by Response Code";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.indonesian webalizer-2.01.10/lang/webalizer_lang.indonesian
--- webalizer-2.01.10~/lang/webalizer_lang.indonesian	2000-10-06 02:27:48.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.indonesian	2006-05-24 19:05:11.000000000 -0300
@@ -197,7 +197,9 @@
 char *msg_h_visits= "Kunjungan";
 char *msg_h_files = "File";
 char *msg_h_sites = "Situs";
-char *msg_h_xfer  = "KByte";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Nama Host";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Browser/User Agent";
@@ -223,7 +225,9 @@
 char *msg_mtot_ms = "Statistik bulanan untuk";
 char *msg_mtot_th = "Jumlah Hit";
 char *msg_mtot_tf = "Jumlah File";
-char *msg_mtot_tx = "Jumlah KByte";
+char *msg_mtot_tx = "Jumlah kB File";
+char *msg_mtot_ix = "Jumlah kB In";
+char *msg_mtot_ox = "Jumlah kB Out";
 char *msg_mtot_us = "Jumlah Situs unik";
 char *msg_mtot_ur = "Jumlah Acuan unik";
 char *msg_mtot_ua = "Jumlah Browser unik";
@@ -234,7 +238,9 @@
 char *msg_mtot_mfd= "File per hari";
 char *msg_mtot_mpd= "Halaman per hari";
 char *msg_mtot_mvd= "Kunjungan per hari";
-char *msg_mtot_mkd= "KByte per hari";
+char *msg_mtot_mkd= "kB File per hari";
+char *msg_mtot_ikd= "kB In per hari";
+char *msg_mtot_okd= "kB Out per hari";
 char *msg_mtot_rc = "Hit oleh kode respon";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.italian webalizer-2.01.10/lang/webalizer_lang.italian
--- webalizer-2.01.10~/lang/webalizer_lang.italian	2000-10-06 02:27:48.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.italian	2006-05-24 19:05:11.000000000 -0300
@@ -196,7 +196,9 @@
 char *msg_h_visits= "Visite";
 char *msg_h_files = "File";
 char *msg_h_sites = "Siti";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Nomi di Host";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Browser";
@@ -222,7 +224,9 @@
 char *msg_mtot_ms = "Statistiche Mensili per";
 char *msg_mtot_th = "Contatti";
 char *msg_mtot_tf = "File";
-char *msg_mtot_tx = "KBytes";
+char *msg_mtot_tx = "kB File";
+char *msg_mtot_ix = "kB In";
+char *msg_mtot_ox = "kB Out";
 char *msg_mtot_us = "Nomi di Host";
 char *msg_mtot_ur = "Referrer";
 char *msg_mtot_ua = "Browser";
@@ -233,7 +237,9 @@
 char *msg_mtot_mfd= "File Giornalieri";
 char *msg_mtot_mpd= "Pagine Giornaliere";
 char *msg_mtot_mvd= "Visite Giornaliere";
-char *msg_mtot_mkd= "KBytes Giornalieri";
+char *msg_mtot_mkd= "kB File Giornalieri";
+char *msg_mtot_ikd= "kB In Giornalieri";
+char *msg_mtot_okd= "kB Out Giornalieri";
 char *msg_mtot_rc = "Contatti per Codice di Risposta";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.japanese webalizer-2.01.10/lang/webalizer_lang.japanese
--- webalizer-2.01.10~/lang/webalizer_lang.japanese	2001-10-23 03:46:24.000000000 -0200
+++ webalizer-2.01.10/lang/webalizer_lang.japanese	2006-05-24 19:05:11.000000000 -0300
@@ -189,7 +189,9 @@
 char *msg_h_visits= "Visits";
 char *msg_h_files = "Files";
 char *msg_h_sites = "Sites";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "¥Û¥¹¥ÈÌ¾";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "¥æ¡¼¥¶¥¨¡¼¥¸¥§¥ó¥È";
@@ -216,6 +218,8 @@
 char *msg_mtot_th = "Á´¥Ò¥Ã¥È¿ô";
 char *msg_mtot_tf = "Á´¥Õ¥¡¥¤¥ë¿ô";
 char *msg_mtot_tx = "Á´ KBytes¿ô";
+char *msg_mtot_ix = "Total kB In";
+char *msg_mtot_ox = "Total kB Out";
 char *msg_mtot_us = "¸ÄÊÌ¥µ¥¤¥È¿ô";
 char *msg_mtot_ur = "¸ÄÊÌ¥ê¥Õ¥¡¥é¡¼¿ô";
 char *msg_mtot_ua = "¸ÄÊÌ¥æ¡¼¥¶¥¨¡¼¥¸¥§¥ó¥È¿ô";
@@ -227,6 +231,8 @@
 char *msg_mtot_mpd= "°ìÆü¤¢¤¿¤ê¤Î¥Ú¡¼¥¸¿ô";
 char *msg_mtot_mvd= "°ìÆü¤¢¤¿¤ê¤ÎË¬Ìä¼Ô¿ô";
 char *msg_mtot_mkd= "°ìÆü¤¢¤¿¤ê¤ÎKBytes¿ô";
+char *msg_mtot_ikd= "kB In per day";
+char *msg_mtot_okd= "kB Out per day";
 char *msg_mtot_rc = "¥ì¥¹¥Ý¥ó¥¹¥³¡¼¥É¤´¤È¤Î¥Ò¥Ã¥È¿ô";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.korean webalizer-2.01.10/lang/webalizer_lang.korean
--- webalizer-2.01.10~/lang/webalizer_lang.korean	2000-10-20 01:54:20.000000000 -0200
+++ webalizer-2.01.10/lang/webalizer_lang.korean	2006-05-24 19:05:11.000000000 -0300
@@ -193,7 +193,9 @@
 char *msg_h_visits= "Visits";
 char *msg_h_files = "Files";
 char *msg_h_sites = "Sites";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "È£½ºÆ®¸í";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "¿¡ÀÌÀüÆ®";
@@ -219,7 +221,9 @@
 char *msg_mtot_ms = "¿ùº° Åë°è";
 char *msg_mtot_th = "ÃÑ È÷Æ®¼ö";
 char *msg_mtot_tf = "ÃÑ ÆÄÀÏ¼ö";
-char *msg_mtot_tx = "ÃÑ KByte";
+char *msg_mtot_tx = "ÃÑ kB ÆÄÀÏ¼ö";
+char *msg_mtot_ix = "ÃÑ kB In";
+char *msg_mtot_ox = "ÃÑ kB Out";
 char *msg_mtot_us = "ÃÑ °³º° »çÀÌÆ®";
 char *msg_mtot_ur = "ÃÑ °³º° ·¹ÆÛ·²";
 char *msg_mtot_ua = "ÃÑ °³º° ¿¡ÀÌÀüÆ®";
@@ -230,7 +234,9 @@
 char *msg_mtot_mfd= "Files per Day";
 char *msg_mtot_mpd= "Pages per Day";
 char *msg_mtot_mvd= "Visits per Day";
-char *msg_mtot_mkd= "KBytes per Day";
+char *msg_mtot_mkd= "kB Files per Day";
+char *msg_mtot_ikd= "kB In per Day";
+char *msg_mtot_okd= "kB Out per Day";
 char *msg_mtot_rc = "ÀÀ´ä ÄÚµåº° È÷Æ®¼ö";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.latvian webalizer-2.01.10/lang/webalizer_lang.latvian
--- webalizer-2.01.10~/lang/webalizer_lang.latvian	2000-10-19 00:59:56.000000000 -0200
+++ webalizer-2.01.10/lang/webalizer_lang.latvian	2006-05-24 19:05:11.000000000 -0300
@@ -195,7 +195,9 @@
 char *msg_h_visits= "Apmeklçjumi";
 char *msg_h_files = "Faili";
 char *msg_h_sites = "Sites";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Hostname";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Lietotâja programma";
@@ -221,7 +223,9 @@
 char *msg_mtot_ms = "Mçneðu pârskats pâr";
 char *msg_mtot_th = "Kopçjie Apmeklçjumi";
 char *msg_mtot_tf = "Kopçjie Faili";
-char *msg_mtot_tx = "Kopçjie KBaiti";
+char *msg_mtot_tx = "Kopçjie kB Faili";
+char *msg_mtot_ix = "Kopçjie kB In";
+char *msg_mtot_ox = "Kopçjie kB Out";
 char *msg_mtot_us = "Kopçjâs Unikâlâs Saites";
 char *msg_mtot_ur = "Kopçjie Unikâlie Referreri";
 char *msg_mtot_ua = "Kopçjâs Unikâlâs Lietotâju Programmas";
@@ -232,7 +236,9 @@
 char *msg_mtot_mfd= "Faili Dienâ";
 char *msg_mtot_mpd= "Lapas Dienâ";
 char *msg_mtot_mvd= "Apmeklçjumi Dienâ";
-char *msg_mtot_mkd= "KBaiti dienâ";
+char *msg_mtot_mkd= "kB Faili dienâ";
+char *msg_mtot_ikd= "kB In dienâ";
+char *msg_mtot_okd= "kB Out dienâ";
 char *msg_mtot_rc = "Hits by Response Code";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.malay webalizer-2.01.10/lang/webalizer_lang.malay
--- webalizer-2.01.10~/lang/webalizer_lang.malay	2000-10-30 23:44:47.000000000 -0200
+++ webalizer-2.01.10/lang/webalizer_lang.malay	2006-05-24 19:05:11.000000000 -0300
@@ -195,7 +195,9 @@
 char *msg_h_visits= "Lawatan";
 char *msg_h_files = "Fail";
 char *msg_h_sites = "Halaman";
-char *msg_h_xfer  = "KBait";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Nama Hos";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Agen Pengguna";
@@ -221,7 +223,9 @@
 char *msg_mtot_ms = "Statistik Bulanan Untuk";
 char *msg_mtot_th = "Jumlah Capaian";
 char *msg_mtot_tf = "Jumlah Fail";
-char *msg_mtot_tx = "Jumlah KBait";
+char *msg_mtot_tx = "Jumlah kB Fail";
+char *msg_mtot_ix = "Jumlah kB In";
+char *msg_mtot_ox = "Jumlah kB Out";
 char *msg_mtot_us = "Jumlah Halaman Unik";
 char *msg_mtot_ur = "Jumlah Perujuk Unik";
 char *msg_mtot_ua = "Jumlah Agen Pengguna Unik";
@@ -232,7 +236,9 @@
 char *msg_mtot_mfd= "Purata Fail Sehari";
 char *msg_mtot_mpd= "Purata Halaman Sehari";
 char *msg_mtot_mvd= "Purata Lawatan Sehari";
-char *msg_mtot_mkd= "Purata KBait Sehari";
+char *msg_mtot_mkd= "Purata kB Sehari Fail";
+char *msg_mtot_ikd= "Purata kB Sehari In";
+char *msg_mtot_okd= "Purata kB Sehari Out";
 char *msg_mtot_rc = "Purata Capaian mengikut Kod Respon";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.norwegian webalizer-2.01.10/lang/webalizer_lang.norwegian
--- webalizer-2.01.10~/lang/webalizer_lang.norwegian	2000-11-18 17:17:23.000000000 -0200
+++ webalizer-2.01.10/lang/webalizer_lang.norwegian	2006-05-24 19:05:11.000000000 -0300
@@ -205,7 +205,9 @@
 char *msg_h_visits= "Besøk";
 char *msg_h_files = "Filer";
 char *msg_h_sites = "Klientadresser";
-char *msg_h_xfer  = "kilobyte";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Servernavn";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Klienttype";
@@ -231,7 +233,9 @@
 char *msg_mtot_ms = "Månedlig statistikk for";
 char *msg_mtot_th = "Totalt antall treff";
 char *msg_mtot_tf = "Totalt antall filer";
-char *msg_mtot_tx = "Totalt antall kilobytes";
+char *msg_mtot_tx = "Totalt antall kB filer";
+char *msg_mtot_ix = "Totalt antall kB in";
+char *msg_mtot_ox = "Totalt antall kB out";
 char *msg_mtot_us = "Totalt antall unike klientadresser";
 char *msg_mtot_ur = "Totalt antall unike henvisninger";
 char *msg_mtot_ua = "Totalt antall unike klienttyper";
@@ -242,7 +246,9 @@
 char *msg_mtot_mfd= "Filer per dag";
 char *msg_mtot_mpd= "Sider per dag";
 char *msg_mtot_mvd= "Besök per dag";
-char *msg_mtot_mkd= "Kilobytes per dag";
+char *msg_mtot_mkd= "kB Filer per dag";
+char *msg_mtot_ikd= "kB In per dag";
+char *msg_mtot_okd= "kB Out per dag";
 char *msg_mtot_rc = "Treff sortert etter responskode";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.polish webalizer-2.01.10/lang/webalizer_lang.polish
--- webalizer-2.01.10~/lang/webalizer_lang.polish	2000-10-06 02:27:48.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.polish	2006-05-24 19:05:11.000000000 -0300
@@ -201,7 +201,9 @@
 char *msg_h_visits= "Wizyty";
 char *msg_h_files = "Pliki";
 char *msg_h_sites = "Lokalizacje";
-char *msg_h_xfer  = "KB";
+char *msg_h_xfer  = "kB P";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Nazwa hosta";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Przegl±darka";
@@ -227,7 +229,9 @@
 char *msg_mtot_ms = "Statystyka w miesi±cu:";
 char *msg_mtot_th = "Ca³kowita liczba wywo³añ";
 char *msg_mtot_tf = "Ca³kowita liczba plików";
-char *msg_mtot_tx = "Ca³kowita liczba KB";
+char *msg_mtot_tx = "Ca³kowita liczba kB plików";
+char *msg_mtot_ix = "Ca³kowita liczba kB in";
+char *msg_mtot_ox = "Ca³kowita liczba kB out";
 char *msg_mtot_us = "Ca³kowita liczba unikalnych lokalizacji";
 char *msg_mtot_ur = "Ca³kowita liczba unikalnych odno¶ników";
 char *msg_mtot_ua = "Ca³kowita liczba unikalnych przegl±darek";
@@ -238,7 +242,9 @@
 char *msg_mtot_mfd= "Plików dziennie";
 char *msg_mtot_mpd= "Stron dziennie";
 char *msg_mtot_mvd= "Wizyt dziennie";
-char *msg_mtot_mkd= "Kilobajtów dziennie";
+char *msg_mtot_mkd= "kB Plików dziennie";
+char *msg_mtot_ikd= "kB In dziennie";
+char *msg_mtot_okd= "kB Out dziennie";
 char *msg_mtot_rc = "Wywo³ania wed³ug kodu odpowiedzi";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.portuguese webalizer-2.01.10/lang/webalizer_lang.portuguese
--- webalizer-2.01.10~/lang/webalizer_lang.portuguese	2002-04-16 18:37:00.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.portuguese	2006-05-24 19:05:11.000000000 -0300
@@ -200,7 +200,9 @@
 char *msg_h_visits= "Visitas";
 char *msg_h_files = "Ficheiros";
 char *msg_h_sites = "Sites";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Hostname";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "User Agent";
@@ -226,7 +228,9 @@
 char *msg_mtot_ms = "Estatística Mensal de";
 char *msg_mtot_th = "Total de Hits";
 char *msg_mtot_tf = "Total de Ficheiros";
-char *msg_mtot_tx = "Total de KBytes";
+char *msg_mtot_tx = "Total de kB Ficheiros";
+char *msg_mtot_ix = "Total de kB In";
+char *msg_mtot_ox = "Total de kB Out";
 char *msg_mtot_us = "Total de Sites Únicos";
 char *msg_mtot_ur = "Total de Referrers Únicos";
 char *msg_mtot_ua = "Total de User Agents Únicos";
@@ -237,7 +241,9 @@
 char *msg_mtot_mfd= "Files por Dia";
 char *msg_mtot_mpd= "Paginas por Dia";
 char *msg_mtot_mvd= "Visitas por Dia";
-char *msg_mtot_mkd= "KBytes por Dia";
+char *msg_mtot_mkd= "kB Files por Dia";
+char *msg_mtot_ikd= "kB In por Dia";
+char *msg_mtot_okd= "kB Out por Dia";
 char *msg_mtot_rc = "Hits por Código de Resposta";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.portuguese_brazil webalizer-2.01.10/lang/webalizer_lang.portuguese_brazil
--- webalizer-2.01.10~/lang/webalizer_lang.portuguese_brazil	2000-10-06 02:27:48.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.portuguese_brazil	2006-05-24 19:05:11.000000000 -0300
@@ -198,7 +198,9 @@
 char *msg_h_visits= "Visitas";
 char *msg_h_files = "Arquivos";
 char *msg_h_sites = "Endereços";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "kB A";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Servidores";
 char *msg_h_url   = "URLs";
 char *msg_h_agent = "Programa cliente";
@@ -224,7 +226,9 @@
 char *msg_mtot_ms = "Estatísticas Mensais para";
 char *msg_mtot_th = "Total de hits";
 char *msg_mtot_tf = "Total de arquivos";
-char *msg_mtot_tx = "Total de KBytes";
+char *msg_mtot_tx = "Total de kB arquivos";
+char *msg_mtot_ix = "Total de kB in";
+char *msg_mtot_ox = "Total de kB out";
 char *msg_mtot_us = "Total de servidores";
 char *msg_mtot_ur = "Total de refer&ecirc;ncias";
 char *msg_mtot_ua = "Total de programas clientes";
@@ -235,7 +239,9 @@
 char *msg_mtot_mfd= "Arquivos por Dia";
 char *msg_mtot_mpd= "Páginas por Dia";
 char *msg_mtot_mvd= "Visitas por Dia";
-char *msg_mtot_mkd= "KBytes por Dia";
+char *msg_mtot_mkd= "kB Arquivos por Dia";
+char *msg_mtot_ikd= "kB In por Dia";
+char *msg_mtot_okd= "kB Out por Dia";
 char *msg_mtot_rc = "Hits por código de resposta";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.romanian webalizer-2.01.10/lang/webalizer_lang.romanian
--- webalizer-2.01.10~/lang/webalizer_lang.romanian	2001-10-23 03:52:51.000000000 -0200
+++ webalizer-2.01.10/lang/webalizer_lang.romanian	2006-05-24 19:05:11.000000000 -0300
@@ -195,7 +195,9 @@
 char *msg_h_visits= "Vizite";
 char *msg_h_files = "Fisiere";
 char *msg_h_sites = "Situri";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Nume";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Navigator";
@@ -221,7 +223,9 @@
 char *msg_mtot_ms = "Statistici lunare pentru";
 char *msg_mtot_th = "Total accesari";
 char *msg_mtot_tf = "Total fisiere";
-char *msg_mtot_tx = "Total Kbytes";
+char *msg_mtot_tx = "Total kB fisiere";
+char *msg_mtot_ix = "Total kB in";
+char *msg_mtot_ox = "Total kB out";
 char *msg_mtot_us = "Total situri unice";
 char *msg_mtot_ur = "Total pagini referente unice";
 char *msg_mtot_ua = "Total navigatoare";
@@ -232,7 +236,9 @@
 char *msg_mtot_mfd= "Fisiere pe zi";
 char *msg_mtot_mpd= "Pagini pe zi";
 char *msg_mtot_mvd= "Vizite pe zi";
-char *msg_mtot_mkd= "KBytes pe zi";
+char *msg_mtot_mkd= "kB Fisiere pe zi";
+char *msg_mtot_ikd= "kB In pe zi";
+char *msg_mtot_okd= "kB Out pe zi";
 char *msg_mtot_rc = "Accesari dupa codul de raspuns";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.romanian-iso-8859-2 webalizer-2.01.10/lang/webalizer_lang.romanian-iso-8859-2
--- webalizer-2.01.10~/lang/webalizer_lang.romanian-iso-8859-2	2001-10-23 03:53:38.000000000 -0200
+++ webalizer-2.01.10/lang/webalizer_lang.romanian-iso-8859-2	2006-05-24 19:05:11.000000000 -0300
@@ -196,7 +196,9 @@
 char *msg_h_visits= "Vizite";
 char *msg_h_files = "Fiºiere";
 char *msg_h_sites = "Situri";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Nume";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Navigator";
@@ -222,7 +224,9 @@
 char *msg_mtot_ms = "Statistici lunare pentru";
 char *msg_mtot_th = "Total accesãri";
 char *msg_mtot_tf = "Total fiºiere";
-char *msg_mtot_tx = "Total Kbytes";
+char *msg_mtot_tx = "Total kB fiºiere";
+char *msg_mtot_ix = "Total kB in";
+char *msg_mtot_ox = "Total kB out";
 char *msg_mtot_us = "Total situri unice";
 char *msg_mtot_ur = "Total pagini referente unice";
 char *msg_mtot_ua = "Total navigatoare";
@@ -233,7 +237,9 @@
 char *msg_mtot_mfd= "Fiºiere pe zi";
 char *msg_mtot_mpd= "Pagini pe zi";
 char *msg_mtot_mvd= "Vizite pe zi";
-char *msg_mtot_mkd= "KBytes pe zi";
+char *msg_mtot_mkd= "kB Fiºiere pe zi";
+char *msg_mtot_ikd= "kB In pe zi";
+char *msg_mtot_okd= "kB Out pe zi";
 char *msg_mtot_rc = "Accesãri dupã codul de rãspuns";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.russian webalizer-2.01.10/lang/webalizer_lang.russian
--- webalizer-2.01.10~/lang/webalizer_lang.russian	2000-10-06 02:27:49.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.russian	2006-05-24 19:05:11.000000000 -0300
@@ -206,7 +206,9 @@
 char *msg_h_visits= "ÐÏÓÅÝÅÎÉÊ";
 char *msg_h_files = "ÆÁÊÌÏ×";
 char *msg_h_sites = "ÓÁÊÔÏ×";
-char *msg_h_xfer  = "ëÂÁÊÔ";
+char *msg_h_xfer  = "kB Æ";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "éÍÑ ÈÏÓÔÁ";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "âÒÏÕÚÅÒ";
@@ -232,7 +234,9 @@
 char *msg_mtot_ms = "óÔÁÔÉÓÔÉËÁ ÚÁ ÍÅÓÑÃ ÎÁ";
 char *msg_mtot_th = "÷ÓÅÇÏ ÚÁÐÒÏÓÏ×";
 char *msg_mtot_tf = "÷ÓÅÇÏ ÆÁÊÌÏ×";
-char *msg_mtot_tx = "÷ÓÅÇÏ ËÉÌÏÂÁÊÔ";
+char *msg_mtot_tx = "÷ÓÅÇÏ kB ÆÁÊÌÏ×";
+char *msg_mtot_ix = "÷ÓÅÇÏ kB In";
+char *msg_mtot_ox = "÷ÓÅÇÏ kB Out";
 char *msg_mtot_us = "÷ÓÅÇÏ ÕÎÉËÁÌØÎÙÈ ÓÁÊÔÏ×";
 char *msg_mtot_ur = "÷ÓÅÇÏ ÕÎÉËÁÌØÎÙÈ ÓÓÙÌÁÀÝÉÈÓÑ ÓÔÒÁÎÉÃ";
 char *msg_mtot_ua = "÷ÓÅÇÏ ÕÎÉËÁÌØÎÙÈ ÂÒÏÕÚÅÒÏ×";
@@ -244,6 +248,8 @@
 char *msg_mtot_mpd= "óÔÒÁÎÉÃ × ÄÅÎØ";
 char *msg_mtot_mvd= "ðÏÓÅÝÅÎÉÊ × ÄÅÎØ";
 char *msg_mtot_mkd= "ïÂß£Í × ÄÅÎØ (ëÂÁÊÔ)";
+char *msg_mtot_ikd= "kB In per day";
+char *msg_mtot_okd= "kB Out per day";
 char *msg_mtot_rc = "úÁÐÒÏÓÙ ÐÏ ËÏÄÁÍ ÏÔ×ÅÔÁ";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.serbian webalizer-2.01.10/lang/webalizer_lang.serbian
--- webalizer-2.01.10~/lang/webalizer_lang.serbian	2000-10-18 23:43:45.000000000 -0200
+++ webalizer-2.01.10/lang/webalizer_lang.serbian	2006-05-24 19:05:11.000000000 -0300
@@ -189,7 +189,9 @@
 char *msg_h_visits= "Poseta";
 char *msg_h_files = "Fajlova";
 char *msg_h_sites = "Racunara";
-char *msg_h_xfer  = "KB";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB U";
+char *msg_h_oxfer = "kB Van";
 char *msg_h_hname = "Racunar";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Korisnicki program";
@@ -215,7 +217,9 @@
 char *msg_mtot_ms = "Mesecna statistika za";
 char *msg_mtot_th = "Ukupno pristupa";
 char *msg_mtot_tf = "Ukupno fajlova";
-char *msg_mtot_tx = "Ukupno KBajta";
+char *msg_mtot_tx = "Ukupno kB fajlova";
+char *msg_mtot_ix = "Ukupno kB unutra";
+char *msg_mtot_ox = "Ukupno kB van";
 char *msg_mtot_us = "Ukupno razlicitih racunara";
 char *msg_mtot_ur = "Ukupno razlicitih referisanja";
 char *msg_mtot_ua = "Ukupno razlicitih browsera";
@@ -226,7 +230,9 @@
 char *msg_mtot_mfd= "Fajlova na dan";
 char *msg_mtot_mpd= "Fajlova na sat";
 char *msg_mtot_mvd= "Poseta na dan";
-char *msg_mtot_mkd= "KBajta na dan";
+char *msg_mtot_mkd= "kB Fajlova na dan";
+char *msg_mtot_ikd= "kB unutra na dan";
+char *msg_mtot_okd= "kB van na dan";
 char *msg_mtot_rc = "Pristupa po kodu";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.simplified_chinese webalizer-2.01.10/lang/webalizer_lang.simplified_chinese
--- webalizer-2.01.10~/lang/webalizer_lang.simplified_chinese	2000-12-17 02:56:07.000000000 -0200
+++ webalizer-2.01.10/lang/webalizer_lang.simplified_chinese	2006-05-24 19:05:11.000000000 -0300
@@ -188,7 +188,9 @@
 char *msg_h_visits= "·ÃÎÊ";
 char *msg_h_files = "ÎÄ¼þ";
 char *msg_h_sites = "Õ¾µã";
-char *msg_h_xfer  = "Ç§×Ö½Ú";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Ö÷»úÃû";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "ÓÃ»§´úÀí";
@@ -215,6 +217,8 @@
 char *msg_mtot_th = "×Üµã»÷Êý";
 char *msg_mtot_tf = "×ÜÎÄ¼þÊý";
 char *msg_mtot_tx = "×ÜÇ§×Ö½ÚÊý";
+char *msg_mtot_ix = "Total kB In";
+char *msg_mtot_ox = "Total kB Out";
 char *msg_mtot_us = "×ÜÕ¾µãÊý£¨²»°üÀ¨ÖØ¸´Õ¾µã£©";
 char *msg_mtot_ur = "×ÜÒýÓÃÕßÊý£¨²»°üÀ¨ÖØ¸´ÒýÓÃÕß£©";
 char *msg_mtot_ua = "×ÜÓÃ»§´úÀíÊý£¨²»°üÀ¨ÖØ¸´ÓÃ»§´úÀí£©";
@@ -226,6 +230,8 @@
 char *msg_mtot_mpd= "Ã¿ÌìÒ³ÃæÊý";
 char *msg_mtot_mvd= "Ã¿Ìì·ÃÎÊÊý";
 char *msg_mtot_mkd= "Ã¿ÌìÁ÷Á¿Êý£¨µ¥Î»£ºÇ§×Ö½Ú£©";
+char *msg_mtot_ikd= "kB In per day";
+char *msg_mtot_okd= "kB Out per day";
 char *msg_mtot_rc = "°´ÏìÓ¦ÂëµÄµã»÷Êý";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.slovak webalizer-2.01.10/lang/webalizer_lang.slovak
--- webalizer-2.01.10~/lang/webalizer_lang.slovak	2000-10-06 02:27:49.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.slovak	2006-05-24 19:05:11.000000000 -0300
@@ -198,7 +198,9 @@
 char *msg_h_visits= "náv¹tev";
 char *msg_h_files = "súborov";
 char *msg_h_sites = "miest";
-char *msg_h_xfer  = "kBytov";
+char *msg_h_xfer  = "kB S";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "poèítaè";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "prehliadaè";
@@ -224,7 +226,9 @@
 char *msg_mtot_ms = "Mesaèné ¹tatistiky za";
 char *msg_mtot_th = "Celkom zásahov";
 char *msg_mtot_tf = "Celkom súborov";
-char *msg_mtot_tx = "Celkom kBytov";
+char *msg_mtot_tx = "Celkom kB súborov";
+char *msg_mtot_ix = "Celkom kB in";
+char *msg_mtot_ox = "Celkom kB out";
 char *msg_mtot_us = "Celkom jedineèných miest";
 char *msg_mtot_ur = "Celkom jedineèných odkazovaèov";
 char *msg_mtot_ua = "Celkom jedineèných Browsrov";
@@ -235,7 +239,9 @@
 char *msg_mtot_mfd= "Súborov za deò";
 char *msg_mtot_mpd= "Stránok za deò";
 char *msg_mtot_mvd= "Náv¹tev za deò";
-char *msg_mtot_mkd= "kBytov za deò";
+char *msg_mtot_mkd= "kB Súborov za deò";
+char *msg_mtot_ikd= "kB In za deò";
+char *msg_mtot_okd= "kB Out za deò";
 char *msg_mtot_rc = "Zásahy podµa kódu odpovede";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.slovene webalizer-2.01.10/lang/webalizer_lang.slovene
--- webalizer-2.01.10~/lang/webalizer_lang.slovene	2000-10-06 02:27:49.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.slovene	2006-05-24 19:05:11.000000000 -0300
@@ -189,7 +189,9 @@
 char *msg_h_visits= "Obiskov";
 char *msg_h_files = "Datotek";
 char *msg_h_sites = "Po podroèjih";
-char *msg_h_xfer  = "KB";
+char *msg_h_xfer  = "kB D";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Gostitelj";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Brskalnik";
@@ -215,7 +217,9 @@
 char *msg_mtot_ms = "Meseèno poroèilo za";
 char *msg_mtot_th = "Skupaj zahtevkov";
 char *msg_mtot_tf = "Skupaj datotek";
-char *msg_mtot_tx = "Skupaj KB";
+char *msg_mtot_tx = "Skupaj kB datotek";
+char *msg_mtot_ix = "Skupaj kB in";
+char *msg_mtot_ox = "Skupaj kB out";
 char *msg_mtot_us = "Skupaj enkr. podroèij";
 char *msg_mtot_ur = "Skupaj enkr. napotiteljev";
 char *msg_mtot_ua = "Skupaj enkr. brskalnikov";
@@ -226,7 +230,9 @@
 char *msg_mtot_mfd= "Datotek dnevno";
 char *msg_mtot_mpd= "Strani dnevno";
 char *msg_mtot_mvd= "Obiskov dnevno";
-char *msg_mtot_mkd= "KB dnevno";
+char *msg_mtot_mkd= "kB Datotek dnevno";
+char *msg_mtot_ikd= "kB In dnevno";
+char *msg_mtot_okd= "kB Out dnevno";
 char *msg_mtot_rc = "Zahtevki po odzivnih kodah";

 /* daily Skupaj table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.spanish webalizer-2.01.10/lang/webalizer_lang.spanish
--- webalizer-2.01.10~/lang/webalizer_lang.spanish	2002-04-16 18:54:31.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.spanish	2006-05-24 19:05:11.000000000 -0300
@@ -205,7 +205,9 @@
 char *msg_h_visits= "Visitas";
 char *msg_h_files = "Archivos";
 char *msg_h_sites = "Clientes";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "kB A";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Máquina";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Navegador";
@@ -231,7 +233,9 @@
 char *msg_mtot_ms = "Estadísticas mensuales de";
 char *msg_mtot_th = "Total Accesos";
 char *msg_mtot_tf = "Total Archivos";
-char *msg_mtot_tx = "Total KBytes";
+char *msg_mtot_tx = "Total kB Archivos";
+char *msg_mtot_ix = "Total kB In";
+char *msg_mtot_ox = "Total kB Out";
 char *msg_mtot_us = "Total Clientes";
 char *msg_mtot_ur = "Total Enlaces origen";
 char *msg_mtot_ua = "Total Navegadores";
@@ -242,7 +246,9 @@
 char *msg_mtot_mfd= "Archivos por Día";
 char *msg_mtot_mpd= "Páginas por Día";
 char *msg_mtot_mvd= "Visitas por Día";
-char *msg_mtot_mkd= "KBytes por Día";
+char *msg_mtot_mkd= "kB Archivos por Día";
+char *msg_mtot_ikd= "kB In por Día";
+char *msg_mtot_okd= "kB Out por Día";
 char *msg_mtot_rc = "Accesos por código de respuesta";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.swedish webalizer-2.01.10/lang/webalizer_lang.swedish
--- webalizer-2.01.10~/lang/webalizer_lang.swedish	2000-10-06 02:27:49.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.swedish	2006-05-24 19:05:11.000000000 -0300
@@ -205,7 +205,9 @@
 char *msg_h_visits= "Besökare";
 char *msg_h_files = "Filer";
 char *msg_h_sites = "Klientadresser";
-char *msg_h_xfer  = "kilobyte";
+char *msg_h_xfer  = "kB F";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Ut";
 char *msg_h_hname = "Värdnamn";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Klienttyp";
@@ -231,7 +233,9 @@
 char *msg_mtot_ms = "Månatlig statistik för";
 char *msg_mtot_th = "Totalt antal träffar";
 char *msg_mtot_tf = "Totalt antal filer";
-char *msg_mtot_tx = "Totalt antal kilobytes";
+char *msg_mtot_tx = "Totalt antal kB filer";
+char *msg_mtot_ix = "Totalt antal kB in";
+char *msg_mtot_ox = "Totalt antal kB ut";
 char *msg_mtot_us = "Totalt antal unika klientadresser";
 char *msg_mtot_ur = "Totalt antal unika hänvisningar";
 char *msg_mtot_ua = "Totalt antal unika klienttyper";
@@ -242,7 +246,9 @@
 char *msg_mtot_mfd= "Filer per dag";
 char *msg_mtot_mpd= "Sidor per dag";
 char *msg_mtot_mvd= "Besök per dag";
-char *msg_mtot_mkd= "Kilobytes per dag";
+char *msg_mtot_mkd= "kB Filer per dag";
+char *msg_mtot_ikd= "kB In per dag";
+char *msg_mtot_okd= "kB Ut per dag";
 char *msg_mtot_rc = "Träffar sorterade efter svarskod";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.turkish webalizer-2.01.10/lang/webalizer_lang.turkish
--- webalizer-2.01.10~/lang/webalizer_lang.turkish	2000-10-06 02:27:49.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.turkish	2006-05-24 19:05:11.000000000 -0300
@@ -194,7 +194,9 @@
 char *msg_h_visits= "Ziyaret";
 char *msg_h_files = "Dosya";
 char *msg_h_sites = "Istemci";
-char *msg_h_xfer  = "KBayt'a Gore";
+char *msg_h_xfer  = "kB D";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "Makine Adi";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Kullanici Ajani";
@@ -220,7 +222,9 @@
 char *msg_mtot_ms = "Aylik Istatistikler:";
 char *msg_mtot_th = "Toplam HIT'ler";
 char *msg_mtot_tf = "Toplam Dosyalar";
-char *msg_mtot_tx = "Toplam KBaytlar";
+char *msg_mtot_tx = "Toplam kB Dosyalar";
+char *msg_mtot_ix = "Toplam kB In";
+char *msg_mtot_ox = "Toplam kB Out";
 char *msg_mtot_us = "Toplam Ayni Istemciler";
 char *msg_mtot_ur = "Toplam Ayni Referanslar";
 char *msg_mtot_ua = "Toplam Ayni Kullanici Ajanlari";
@@ -231,7 +235,9 @@
 char *msg_mtot_mfd= "Gunluk Dosyalar";
 char *msg_mtot_mpd= "Gunluk Sayfalar";
 char *msg_mtot_mvd= "Gunluk Ziyaretler";
-char *msg_mtot_mkd= "Gunluk KBaytlar";
+char *msg_mtot_mkd= "Gunluk kB Dosyalar";
+char *msg_mtot_ikd= "Gunluk kB In";
+char *msg_mtot_okd= "Gunluk kB Out";
 char *msg_mtot_rc = "Cevap Koduna Gore HIT";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang/webalizer_lang.ukrainian webalizer-2.01.10/lang/webalizer_lang.ukrainian
--- webalizer-2.01.10~/lang/webalizer_lang.ukrainian	2001-06-15 05:02:49.000000000 -0300
+++ webalizer-2.01.10/lang/webalizer_lang.ukrainian	2006-05-24 19:05:11.000000000 -0300
@@ -197,7 +197,9 @@
 char *msg_h_visits= "×¦Ä×¦Ä.";
 char *msg_h_files = "ÆÁÊÌ¦×";
 char *msg_h_sites = "ÓÁÊÔ¦×";
-char *msg_h_xfer  = "ëâÁÊÔ";
+char *msg_h_xfer  = "kB Æ";
+char *msg_h_ixfer = "kB In";
+char *msg_h_oxfer = "kB Out";
 char *msg_h_hname = "¦Í'Ñ ÈÏÓÔÁ";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "ÁÇÅÎÔ ËÏÒÉÓÔÕ×ÁÞÁ";
@@ -225,7 +227,9 @@
 char *msg_mtot_tf = "÷ÓØÏÇÏ ÆÁÊÌ¦×";
 char *msg_mtot_tp = "÷ÓØÏÇÏ ÓÔÏÒ¦ÎÏË";
 char *msg_mtot_tv = "÷ÓØÏÇÏ ×¦Ä×¦ÄÕ×ÁÎØ";
-char *msg_mtot_tx = "÷ÓØÏÇÏ ëâÁÊÔ";
+char *msg_mtot_tx = "÷ÓØÏÇÏ ëâÁÊÔ ÆÁÊÌ¦×";
+char *msg_mtot_ix = "÷ÓØÏÇÏ ëâÁÊÔ In";
+char *msg_mtot_ox = "÷ÓØÏÇÏ ëâÁÊÔ Out";
 char *msg_mtot_us = "÷ÓØÏÇÏ ÕÎ¦ËÁÌØÎÉÈ ÓÁÊÔ¦×";
 char *msg_mtot_ur = "÷ÓØÏÇÏ ÕÎ¦ËÁÌØÎÉÈ ÐÏÓÉÌÁÎØ";
 char *msg_mtot_ua = "÷ÓØÏÇÏ ÕÎ¦ËÁÌØÎÉÈ ÁÇÅÎÔ¦× ËÏÒÉÓÔÕ×ÁÞÁ";
@@ -236,7 +240,9 @@
 char *msg_mtot_mfd= "æÁÊÌ¦× ÚÁ ÄÅÎØ";
 char *msg_mtot_mpd= "óÔÏÒ¦ÎÏË ÚÁ ÄÅÎØ";
 char *msg_mtot_mvd= "÷¦Ä×¦ÄÕ×ÁÎØ ÚÁ ÄÅÎØ";
-char *msg_mtot_mkd= "KâÁÊÔ ÚÁ ÄÅÎØ";
+char *msg_mtot_mkd= "KâÁÊÔ æÁÊÌ¦× ÚÁ ÄÅÎØ";
+char *msg_mtot_ikd= "KâÁÊÔ In ÚÁ ÄÅÎØ";
+char *msg_mtot_okd= "KâÁÊÔ Out ÚÁ ÄÅÎØ";
 char *msg_mtot_rc = "ú×ÅÒÔÁÎØ ÚÁ ËÏÄÏÍ ×¦ÄÐÏ×¦Ä¦";

 /* daily total table */
diff -urNad webalizer-2.01.10~/lang.h webalizer-2.01.10/lang.h
--- webalizer-2.01.10~/lang.h	2000-09-29 00:50:30.000000000 -0300
+++ webalizer-2.01.10/lang.h	2006-05-24 19:05:11.000000000 -0300
@@ -101,6 +101,8 @@
 extern char *msg_h_files ;
 extern char *msg_h_sites ;
 extern char *msg_h_xfer  ;
+extern char *msg_h_ixfer ;
+extern char *msg_h_oxfer ;
 extern char *msg_h_hname ;
 extern char *msg_h_url   ;
 extern char *msg_h_agent ;
@@ -125,6 +127,8 @@
 extern char *msg_mtot_th ;
 extern char *msg_mtot_tf ;
 extern char *msg_mtot_tx ;
+extern char *msg_mtot_ix ;
+extern char *msg_mtot_ox ;
 extern char *msg_mtot_us ;
 extern char *msg_mtot_ur ;
 extern char *msg_mtot_ua ;
@@ -136,6 +140,8 @@
 extern char *msg_mtot_mpd;
 extern char *msg_mtot_mvd;
 extern char *msg_mtot_mkd;
+extern char *msg_mtot_ikd;
+extern char *msg_mtot_okd;
 extern char *msg_mtot_rc ;

 extern char *msg_dtot_ds ;
diff -urNad webalizer-2.01.10~/output.c webalizer-2.01.10/output.c
--- webalizer-2.01.10~/output.c	2006-05-24 19:05:11.000000000 -0300
+++ webalizer-2.01.10/output.c	2006-05-24 19:05:12.000000000 -0300
@@ -297,6 +297,8 @@
    hist_visit[i] =  t_visit;
    hist_site[i]  =  t_site;
    hist_xfer[i]  =  t_xfer/1024;
+   hist_ixfer[i] =  t_ixfer/1024;
+   hist_oxfer[i] =  t_oxfer/1024;
    hist_fday[i]  =  f_day;
    hist_lday[i]  =  l_day;

@@ -317,8 +319,10 @@
                       tm_file,             /* data 2 (files)    */
                       tm_site,             /* data 3 (sites)    */
                       tm_xfer,             /* data 4 (kbytes)   */
-                      tm_page,             /* data 5 (pages)    */
-                      tm_visit);           /* data 6 (visits)   */
+                      tm_ixfer,            /* data 5 (kbytes)   */
+                      tm_oxfer,            /* data 6 (kbytes)   */
+                      tm_page,             /* data 7 (pages)    */
+                      tm_visit);           /* data 8 (visits)   */
    }

    if (hourly_graph)
@@ -515,7 +519,7 @@
 {
    int i,days_in_month;
    u_int64_t max_files=0,max_hits=0,max_visits=0,max_pages=0;
-   double max_xfer=0.0;
+   double max_xfer=0.0,max_ixfer=0.0,max_oxfer=0.0;

    days_in_month=(l_day-f_day)+1;
    for (i=0;i<31;i++)
@@ -525,6 +529,8 @@
       if (tm_page[i]>max_pages)   max_pages = tm_page[i];
       if (tm_visit[i]>max_visits) max_visits= tm_visit[i];
       if (tm_xfer[i]>max_xfer)    max_xfer  = tm_xfer[i];
+      if (tm_ixfer[i]>max_ixfer)  max_ixfer = tm_ixfer[i];
+      if (tm_oxfer[i]>max_oxfer)  max_oxfer = tm_oxfer[i];
    }

    fprintf(out_fp,"<TABLE WIDTH=510 BORDER=2 CELLSPACING=1 CELLPADDING=1>\n");
@@ -552,6 +558,12 @@
    fprintf(out_fp,"<TR><TD WIDTH=380><FONT SIZE=\"-1\">%s</FONT></TD>\n"     \
       "<TD ALIGN=right COLSPAN=2><FONT SIZE=\"-1\"><B>%.0f</B>"              \
       "</FONT></TD></TR>\n",msg_mtot_tx,t_xfer/1024);
+   fprintf(out_fp,"<TR><TD WIDTH=380><FONT SIZE=\"-1\">%s</FONT></TD>\n"     \
+      "<TD ALIGN=right COLSPAN=2><FONT SIZE=\"-1\"><B>%.0f</B>"              \
+      "</FONT></TD></TR>\n",msg_mtot_ix,t_ixfer/1024);
+   fprintf(out_fp,"<TR><TD WIDTH=380><FONT SIZE=\"-1\">%s</FONT></TD>\n"     \
+      "<TD ALIGN=right COLSPAN=2><FONT SIZE=\"-1\"><B>%.0f</B>"              \
+      "</FONT></TD></TR>\n",msg_mtot_ox,t_oxfer/1024);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    /**********************************************/
    /* Unique Sites */
@@ -630,6 +642,18 @@
       "<TD WIDTH=65 ALIGN=right><FONT SIZE=-1><B>%.0f</B>"                   \
       "</FONT></TD></TR>\n",msg_mtot_mkd,
       (t_xfer/1024)/days_in_month,max_xfer/1024);
+   fprintf(out_fp,"<TR>"                                                     \
+      "<TD><FONT SIZE=\"-1\">%s</FONT></TD>\n"                               \
+      "<TD ALIGN=right WIDTH=65><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
+      "<TD WIDTH=65 ALIGN=right><FONT SIZE=-1><B>%.0f</B>"                   \
+      "</FONT></TD></TR>\n",msg_mtot_ikd,
+      (t_ixfer/1024)/days_in_month,max_ixfer/1024);
+   fprintf(out_fp,"<TR>"                                                     \
+      "<TD><FONT SIZE=\"-1\">%s</FONT></TD>\n"                               \
+      "<TD ALIGN=right WIDTH=65><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
+      "<TD WIDTH=65 ALIGN=right><FONT SIZE=-1><B>%.0f</B>"                   \
+      "</FONT></TD></TR>\n",msg_mtot_okd,
+      (t_oxfer/1024)/days_in_month,max_oxfer/1024);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    /**********************************************/
    /* response code totals */
@@ -663,7 +687,7 @@
    fprintf(out_fp,"<TABLE WIDTH=510 BORDER=2 CELLSPACING=1 CELLPADDING=1>\n");
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    /* Daily statistics for ... */
-   fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" COLSPAN=13 ALIGN=center>"          \
+   fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" COLSPAN=17 ALIGN=center>"          \
            "%s %s %d</TH></TR>\n",
            GREY,msg_dtot_ds,l_month[cur_month-1], cur_year);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
@@ -680,6 +704,10 @@
                   "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"               \
                   "<FONT SIZE=\"-1\">%s</FONT></TH>\n"                       \
                   "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"               \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n"                       \
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"               \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n"                       \
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"               \
                   "<FONT SIZE=\"-1\">%s</FONT></TH></TR>\n",
                   GREY,    msg_h_day,
                   DKGREEN, msg_h_hits,
@@ -687,7 +715,9 @@
                   CYAN,    msg_h_pages,
                   YELLOW,  msg_h_visits,
                   ORANGE,  msg_h_sites,
-                  RED,     msg_h_xfer);
+                  RED,     msg_h_xfer,
+                  LTBLUE,  msg_h_ixfer,
+                  GREEN,   msg_h_oxfer);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");

    /* skip beginning blank days in a month */
@@ -720,8 +750,16 @@
               tm_site[i],PCENT(tm_site[i],t_site));
       fprintf(out_fp,"<TD ALIGN=right>"                                      \
               "<FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n"                  \
-              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD></TR>\n",
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n",
               tm_xfer[i]/1024,PCENT(tm_xfer[i],t_xfer));
+      fprintf(out_fp,"<TD ALIGN=right>"                                      \
+              "<FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n"                  \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n",
+              tm_ixfer[i]/1024,PCENT(tm_ixfer[i],t_ixfer));
+      fprintf(out_fp,"<TD ALIGN=right>"                                      \
+              "<FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n"                  \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD></TR>\n",
+              tm_oxfer[i]/1024,PCENT(tm_oxfer[i],t_oxfer));
    }
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"</TABLE>\n");
@@ -736,14 +774,14 @@
 {
    int i,days_in_month;
    u_int64_t avg_file=0;
-   double avg_xfer=0.0;
+   double avg_xfer=0.0,avg_ixfer=0.0,avg_oxfer=0.0;

    days_in_month=(l_day-f_day)+1;

    /* Hourly stats */
    fprintf(out_fp,"<TABLE WIDTH=510 BORDER=2 CELLSPACING=1 CELLPADDING=1>\n");
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
-   fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" COLSPAN=13 ALIGN=center>"\
+   fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" COLSPAN=19 ALIGN=center>"\
            "%s %s %d</TH></TR>\n",
            GREY,msg_htot_hs,l_month[cur_month-1], cur_year);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
@@ -756,12 +794,18 @@
                   "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=3>"     \
                   "<FONT SIZE=\"-1\">%s</FONT></TH>\n"             \
                   "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=3>"     \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n"        \
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=3>"     \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n"        \
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=3>"     \
                   "<FONT SIZE=\"-1\">%s</FONT></TH></TR>\n",
                   GREY,    msg_h_hour,
                   DKGREEN, msg_h_hits,
                   LTBLUE,  msg_h_files,
                   CYAN,    msg_h_pages,
-                  RED,     msg_h_xfer);
+                  RED,     msg_h_xfer,
+                  LTBLUE,  msg_h_ixfer,
+                  GREEN,   msg_h_oxfer);
    fprintf(out_fp,"<TR><TH ALIGN=center BGCOLOR=\"%s\">"           \
                   "<FONT SIZE=\"-2\">%s</FONT></TH>\n"             \
                   "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"     \
@@ -780,8 +824,18 @@
    fprintf(out_fp,"<TH ALIGN=center BGCOLOR=\"%s\">"               \
                   "<FONT SIZE=\"-2\">%s</FONT></TH>\n"             \
                   "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"     \
-                  "<FONT SIZE=\"-2\">%s</FONT></TH></TR>\n",
+                  "<FONT SIZE=\"-2\">%s</FONT></TH>\n",
                   RED, msg_h_avg, RED, msg_h_total);
+   fprintf(out_fp,"<TH ALIGN=center BGCOLOR=\"%s\">"               \
+                  "<FONT SIZE=\"-2\">%s</FONT></TH>\n"             \
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"     \
+                  "<FONT SIZE=\"-2\">%s</FONT></TH>\n",
+                  LTBLUE, msg_h_avg, LTBLUE, msg_h_total);
+   fprintf(out_fp,"<TH ALIGN=center BGCOLOR=\"%s\">"               \
+                  "<FONT SIZE=\"-2\">%s</FONT></TH>\n"             \
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"     \
+                  "<FONT SIZE=\"-2\">%s</FONT></TH></TR>\n",
+                  GREEN, msg_h_avg, GREEN, msg_h_total);

    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    for (i=0;i<24;i++)
@@ -809,11 +863,25 @@
       fprintf(out_fp,
          "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
          "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
-         "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD></TR>\n",
+         "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n",
          (th_xfer[i]/days_in_month)/1024,th_xfer[i]/1024,
          PCENT(th_xfer[i],t_xfer));
+      fprintf(out_fp,
+         "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
+         "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
+         "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n",
+         (th_ixfer[i]/days_in_month)/1024,th_ixfer[i]/1024,
+         PCENT(th_ixfer[i],t_ixfer));
+      fprintf(out_fp,
+         "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
+         "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
+         "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD></TR>\n",
+         (th_oxfer[i]/days_in_month)/1024,th_oxfer[i]/1024,
+         PCENT(th_oxfer[i],t_oxfer));
       avg_file += th_file[i]/days_in_month;
-      avg_xfer+= (th_xfer[i]/days_in_month)/1024;
+      avg_xfer += (th_xfer[i]/days_in_month)/1024;
+      avg_ixfer+= (th_ixfer[i]/days_in_month)/1024;
+      avg_oxfer+= (th_oxfer[i]/days_in_month)/1024;
    }
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"</TABLE>\n<P>\n");
@@ -851,11 +919,11 @@

    fprintf(out_fp,"<TABLE WIDTH=510 BORDER=2 CELLSPACING=1 CELLPADDING=1>\n");
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
-   if (flag) fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=10>" \
+   if (flag) fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=14>" \
            "%s %lld %s %lld %s %s %s</TH></TR>\n",
            GREY, msg_top_top,tot_num,msg_top_of,
            t_site,msg_top_s,msg_h_by,msg_h_xfer);
-   else      fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=10>" \
+   else      fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=14>" \
            "%s %lld %s %lld %s</TH></TR>\n",
            GREY,msg_top_top, tot_num, msg_top_of, t_site, msg_top_s);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
@@ -868,6 +936,10 @@
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"              \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",RED,msg_h_xfer);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"              \
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",LTBLUE,msg_h_ixfer);
+   fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"              \
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",GREEN,msg_h_oxfer);
+   fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"              \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",YELLOW,msg_h_visits);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center>"                        \
           "<FONT SIZE=\"-1\">%s</FONT></TH></TR>\n",CYAN,msg_h_hname);
@@ -892,13 +964,19 @@
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
               "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
               "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%lld</B></FONT></TD>\n"  \
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
               "<TD ALIGN=left NOWRAP><FONT SIZE=\"-1\">",
               i+1,hptr->count,
               (t_hit==0)?0:((float)hptr->count/t_hit)*100.0,hptr->files,
               (t_file==0)?0:((float)hptr->files/t_file)*100.0,hptr->xfer/1024,
-              (t_xfer==0)?0:((float)hptr->xfer/t_xfer)*100.0,hptr->visit,
+              (t_xfer==0)?0:((float)hptr->xfer/t_xfer)*100.0,hptr->ixfer/1024,
+              (t_ixfer==0)?0:((float)hptr->ixfer/t_ixfer)*100.0,hptr->oxfer/1024,
+              (t_oxfer==0)?0:((float)hptr->oxfer/t_oxfer)*100.0,hptr->visit,
               (t_visit==0)?0:((float)hptr->visit/t_visit)*100.0);

          if ((hptr->flag==OBJ_GRP)&&hlite_groups)
@@ -919,7 +997,7 @@
          if (all_sites_page(h_reg, h_grp))
          {
             fprintf(out_fp,"<TR BGCOLOR=\"%s\">",GRPCOLOR);
-            fprintf(out_fp,"<TD COLSPAN=10 ALIGN=\"center\">\n");
+            fprintf(out_fp,"<TD COLSPAN=14 ALIGN=\"center\">\n");
             fprintf(out_fp,"<FONT SIZE=\"-1\">");
             fprintf(out_fp,"<A HREF=\"./site_%04d%02d.%s\">",
                     cur_year,cur_month,html_ext);
@@ -954,9 +1032,12 @@

    fprintf(out_fp,"<FONT SIZE=\"-1\"></CENTER><PRE>\n");

-   fprintf(out_fp," %12s      %12s      %12s      %12s      %s\n",
-           msg_h_hits, msg_h_files, msg_h_xfer, msg_h_visits, msg_h_hname);
+   fprintf(out_fp," %12s      %12s      %12s      %12s      %12s"          \
+                  "      %12s      %s\n",
+           msg_h_hits, msg_h_files, msg_h_xfer, msg_h_ixfer, msg_h_oxfer,
+           msg_h_visits, msg_h_hname);
    fprintf(out_fp,"----------------  ----------------  ----------------  " \
+                  "----------------  ----------------  "                   \
                   "----------------  --------------------\n\n");

    /* Do groups first (if any) */
@@ -967,11 +1048,14 @@
       if (hptr->flag == OBJ_GRP)
       {
          fprintf(out_fp,
-         "%-8llu %6.02f%%  %8llu %6.02f%%  %8.0f %6.02f%%  %8llu %6.02f%%  %s\n",
+         "%-8llu %6.02f%%  %8llu %6.02f%%  %8.0f %6.02f%%  %8.0f %6.02f%%  "  \
+         "%8.0f %6.02f%%  %8llu %6.02f%%  %s\n",
             hptr->count,
             (t_hit==0)?0:((float)hptr->count/t_hit)*100.0,hptr->files,
             (t_file==0)?0:((float)hptr->files/t_file)*100.0,hptr->xfer/1024,
-            (t_xfer==0)?0:((float)hptr->xfer/t_xfer)*100.0,hptr->visit,
+            (t_xfer==0)?0:((float)hptr->xfer/t_xfer)*100.0,hptr->ixfer/1024,
+            (t_ixfer==0)?0:((float)hptr->ixfer/t_ixfer)*100.0,hptr->oxfer/1024,
+            (t_oxfer==0)?0:((float)hptr->oxfer/t_oxfer)*100.0,hptr->visit,
             (t_visit==0)?0:((float)hptr->visit/t_visit)*100.0,
             hptr->string);
          h_grp--;
@@ -988,11 +1072,14 @@
       if (hptr->flag == OBJ_REG)
       {
          fprintf(out_fp,
-         "%-8llu %6.02f%%  %8llu %6.02f%%  %8.0f %6.02f%%  %8llu %6.02f%%  %s\n",
+         "%-8llu %6.02f%%  %8llu %6.02f%%  %8.0f %6.02f%%  %8.0f %6.02f%%  "  \
+         "%8.0f %6.02f%%  %8llu %6.02f%%  %s\n",
             hptr->count,
             (t_hit==0)?0:((float)hptr->count/t_hit)*100.0,hptr->files,
             (t_file==0)?0:((float)hptr->files/t_file)*100.0,hptr->xfer/1024,
-            (t_xfer==0)?0:((float)hptr->xfer/t_xfer)*100.0,hptr->visit,
+            (t_xfer==0)?0:((float)hptr->xfer/t_xfer)*100.0,hptr->ixfer/1024,
+            (t_ixfer==0)?0:((float)hptr->ixfer/t_ixfer)*100.0,hptr->oxfer/1024,
+            (t_oxfer==0)?0:((float)hptr->oxfer/t_oxfer)*100.0,hptr->visit,
             (t_visit==0)?0:((float)hptr->visit/t_visit)*100.0,
             hptr->string);
          h_reg--;
@@ -1036,11 +1123,11 @@

    fprintf(out_fp,"<TABLE WIDTH=510 BORDER=2 CELLSPACING=1 CELLPADDING=1>\n");
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
-   if (flag) fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=6>"  \
+   if (flag) fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=10>"  \
            "%s %lld %s %lld %s %s %s</TH></TR>\n",
            GREY,msg_top_top,tot_num,msg_top_of,
            t_url,msg_top_u,msg_h_by,msg_h_xfer);
-   else fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=6>"   \
+   else fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=10>"   \
            "%s %lld %s %lld %s</TH></TR>\n",
            GREY,msg_top_top,tot_num,msg_top_of,t_url,msg_top_u);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
@@ -1052,6 +1139,12 @@
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"            \
                   "<FONT SIZE=\"-1\">%s</FONT></TH>\n",
                   RED,msg_h_xfer);
+   fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"            \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n",
+                  LTBLUE,msg_h_ixfer);
+   fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"            \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n",
+                  GREEN,msg_h_oxfer);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center>"                      \
                   "<FONT SIZE=\"-1\">%s</FONT></TH></TR>\n",
                   CYAN,msg_h_url);
@@ -1074,11 +1167,19 @@
             "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
             "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n"\
             "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
+            "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n"\
+            "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
+            "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n"\
+            "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
             "<TD ALIGN=left NOWRAP><FONT SIZE=\"-1\">",
             i+1,uptr->count,
             (t_hit==0)?0:((float)uptr->count/t_hit)*100.0,
             uptr->xfer/1024,
-            (t_xfer==0)?0:((float)uptr->xfer/t_xfer)*100.0);
+            (t_xfer==0)?0:((float)uptr->xfer/t_xfer)*100.0,
+            uptr->ixfer/1024,
+            (t_ixfer==0)?0:((float)uptr->ixfer/t_ixfer)*100.0,
+            uptr->oxfer/1024,
+            (t_oxfer==0)?0:((float)uptr->oxfer/t_oxfer)*100.0);

          if (uptr->flag==OBJ_GRP)
          {
@@ -1124,7 +1225,7 @@
          if (all_urls_page(u_reg, u_grp))
          {
             fprintf(out_fp,"<TR BGCOLOR=\"%s\">",GRPCOLOR);
-            fprintf(out_fp,"<TD COLSPAN=6 ALIGN=\"center\">\n");
+            fprintf(out_fp,"<TD COLSPAN=10 ALIGN=\"center\">\n");
             fprintf(out_fp,"<FONT SIZE=\"-1\">");
             fprintf(out_fp,"<A HREF=\"./url_%04d%02d.%s\">",
                     cur_year,cur_month,html_ext);
@@ -1159,10 +1260,10 @@

    fprintf(out_fp,"<FONT SIZE=\"-1\"></CENTER><PRE>\n");

-   fprintf(out_fp," %12s      %12s      %s\n",
-           msg_h_hits,msg_h_xfer,msg_h_url);
-   fprintf(out_fp,"----------------  ----------------  " \
-                  "--------------------\n\n");
+   fprintf(out_fp," %12s      %12s      %12s      %12s      %s\n",
+           msg_h_hits,msg_h_xfer,msg_h_ixfer,msg_h_oxfer,msg_h_url);
+   fprintf(out_fp,"----------------  ----------------  ----------------  " \
+                  "----------------  --------------------\n\n");

    /* do groups first (if any) */
    pointer=u_array;
@@ -1171,11 +1272,16 @@
       uptr=*pointer++;
       if (uptr->flag == OBJ_GRP)
       {
-         fprintf(out_fp,"%-8llu %6.02f%%  %8.0f %6.02f%%  %s\n",
+         fprintf(out_fp,"%-8llu %6.02f%%  %8.0f %6.02f%%  %8.0f %6.02f%%  "  \
+                        "%8.0f %6.02f%%  %s\n",
             uptr->count,
             (t_hit==0)?0:((float)uptr->count/t_hit)*100.0,
             uptr->xfer/1024,
             (t_xfer==0)?0:((float)uptr->xfer/t_xfer)*100.0,
+            uptr->ixfer/1024,
+            (t_ixfer==0)?0:((float)uptr->ixfer/t_ixfer)*100.0,
+            uptr->oxfer/1024,
+            (t_oxfer==0)?0:((float)uptr->oxfer/t_oxfer)*100.0,
             uptr->string);
          u_grp--;
       }
@@ -1190,11 +1296,16 @@
       uptr=*pointer++;
       if (uptr->flag == OBJ_REG)
       {
-         fprintf(out_fp,"%-8llu %6.02f%%  %8.0f %6.02f%%  %s\n",
+         fprintf(out_fp,"%-8llu %6.02f%%  %8.0f %6.02f%%  %8.0f %6.02f%%  "  \
+                        "%8.0f %6.02f%%  %s\n",
             uptr->count,
             (t_hit==0)?0:((float)uptr->count/t_hit)*100.0,
             uptr->xfer/1024,
             (t_xfer==0)?0:((float)uptr->xfer/t_xfer)*100.0,
+            uptr->ixfer/1024,
+            (t_ixfer==0)?0:((float)uptr->ixfer/t_ixfer)*100.0,
+            uptr->oxfer/1024,
+            (t_oxfer==0)?0:((float)uptr->oxfer/t_oxfer)*100.0,
             uptr->string);
          u_reg--;
       }
@@ -1773,7 +1884,7 @@

    fprintf(out_fp,"<TABLE WIDTH=510 BORDER=2 CELLSPACING=1 CELLPADDING=1>\n");
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
-   fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=10>" \
+   fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=14>" \
            "%s %lld %s %lld %s</TH></TR>\n",
            GREY,msg_top_top, tot_num, msg_top_of, t_user, msg_top_i);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
@@ -1786,6 +1897,10 @@
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"             \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",RED,msg_h_xfer);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"             \
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",LTBLUE,msg_h_ixfer);
+   fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"             \
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",GREEN,msg_h_oxfer);
+   fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"             \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",YELLOW,msg_h_visits);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center>"                       \
           "<FONT SIZE=\"-1\">%s</FONT></TH></TR>\n",CYAN,msg_h_uname);
@@ -1810,13 +1925,19 @@
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
               "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
               "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%lld</B></FONT></TD>\n"  \
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
               "<TD ALIGN=left NOWRAP><FONT SIZE=\"-1\">",
               i+1,iptr->count,
               (t_hit==0)?0:((float)iptr->count/t_hit)*100.0,iptr->files,
               (t_file==0)?0:((float)iptr->files/t_file)*100.0,iptr->xfer/1024,
-              (t_xfer==0)?0:((float)iptr->xfer/t_xfer)*100.0,iptr->visit,
+              (t_xfer==0)?0:((float)iptr->xfer/t_xfer)*100.0,iptr->ixfer/1024,
+              (t_ixfer==0)?0:((float)iptr->ixfer/t_ixfer)*100.0,iptr->oxfer/1024,
+              (t_oxfer==0)?0:((float)iptr->oxfer/t_oxfer)*100.0,iptr->visit,
               (t_visit==0)?0:((float)iptr->visit/t_visit)*100.0);

          if ((iptr->flag==OBJ_GRP)&&hlite_groups)
@@ -1835,7 +1956,7 @@
       if (all_users_page(i_reg, i_grp))
       {
          fprintf(out_fp,"<TR BGCOLOR=\"%s\">",GRPCOLOR);
-         fprintf(out_fp,"<TD COLSPAN=10 ALIGN=\"center\">\n");
+         fprintf(out_fp,"<TD COLSPAN=14 ALIGN=\"center\">\n");
          fprintf(out_fp,"<FONT SIZE=\"-1\">");
          fprintf(out_fp,"<A HREF=\"./user_%04d%02d.%s\">",
             cur_year,cur_month,html_ext);
@@ -1867,9 +1988,12 @@

    fprintf(out_fp,"<FONT SIZE=\"-1\"></CENTER><PRE>\n");

-   fprintf(out_fp," %12s      %12s      %12s      %12s      %s\n",
-           msg_h_hits, msg_h_files, msg_h_xfer, msg_h_visits, msg_h_uname);
+   fprintf(out_fp," %12s      %12s      %12s      %12s      %12s      %12s"\
+                  "      %s\n",
+           msg_h_hits, msg_h_files, msg_h_xfer, msg_h_ixfer, msg_h_oxfer,
+           msg_h_visits, msg_h_uname);
    fprintf(out_fp,"----------------  ----------------  ----------------  " \
+                  "----------------  ----------------  "                   \
                   "----------------  --------------------\n\n");

    /* Do groups first (if any) */
@@ -1880,11 +2004,14 @@
       if (iptr->flag == OBJ_GRP)
       {
          fprintf(out_fp,
-         "%-8llu %6.02f%%  %8llu %6.02f%%  %8.0f %6.02f%%  %8llu %6.02f%%  %s\n",
+         "%-8llu %6.02f%%  %8llu %6.02f%%  %8.0f %6.02f%%  %8.0f %6.02f%%  " \
+         "%8.0f %6.02f%%  %8llu %6.02f%%  %s\n",
             iptr->count,
             (t_hit==0)?0:((float)iptr->count/t_hit)*100.0,iptr->files,
             (t_file==0)?0:((float)iptr->files/t_file)*100.0,iptr->xfer/1024,
-            (t_xfer==0)?0:((float)iptr->xfer/t_xfer)*100.0,iptr->visit,
+            (t_xfer==0)?0:((float)iptr->xfer/t_xfer)*100.0,iptr->ixfer/1024,
+            (t_ixfer==0)?0:((float)iptr->ixfer/t_ixfer)*100.0,iptr->oxfer/1024,
+            (t_oxfer==0)?0:((float)iptr->oxfer/t_oxfer)*100.0,iptr->visit,
             (t_visit==0)?0:((float)iptr->visit/t_visit)*100.0,
             iptr->string);
          i_grp--;
@@ -1901,11 +2028,14 @@
       if (iptr->flag == OBJ_REG)
       {
          fprintf(out_fp,
-         "%-8llu %6.02f%%  %8llu %6.02f%%  %8.0f %6.02f%%  %8llu %6.02f%%  %s\n",
+         "%-8llu %6.02f%%  %8llu %6.02f%%  %8.0f %6.02f%%  %8.0f %6.02f%%  "  \
+         "%8.0f %6.02f%%  %8llu %6.02f%%  %s\n",
             iptr->count,
             (t_hit==0)?0:((float)iptr->count/t_hit)*100.0,iptr->files,
             (t_file==0)?0:((float)iptr->files/t_file)*100.0,iptr->xfer/1024,
-            (t_xfer==0)?0:((float)iptr->xfer/t_xfer)*100.0,iptr->visit,
+            (t_xfer==0)?0:((float)iptr->xfer/t_xfer)*100.0,iptr->ixfer/1024,
+            (t_ixfer==0)?0:((float)iptr->ixfer/t_ixfer)*100.0,iptr->oxfer/1024,
+            (t_oxfer==0)?0:((float)iptr->oxfer/t_oxfer)*100.0,iptr->visit,
             (t_visit==0)?0:((float)iptr->visit/t_visit)*100.0,
             iptr->string);
          i_reg--;
@@ -1993,6 +2123,8 @@
                      ctry[j].count+=hptr->count;
                      ctry[j].files+=hptr->files;
                      ctry[j].xfer +=hptr->xfer;
+                     ctry[j].ixfer+=hptr->ixfer;
+                     ctry[j].oxfer+=hptr->oxfer;
                      ctry_fnd=1;
                      break;
                   }
@@ -2010,6 +2142,8 @@
	       ctry[0].count+=hptr->count;
	       ctry[0].files+=hptr->files;
	       ctry[0].xfer +=hptr->xfer;
+    	       ctry[0].ixfer+=hptr->ixfer;
+    	       ctry[0].oxfer+=hptr->oxfer;
             }
          }
          hptr=hptr->next;
@@ -2063,7 +2197,7 @@
    for (i=0;i<ntop_ctrys;i++) if (top_ctrys[i]->count!=0) tot_num++;
    fprintf(out_fp,"<TABLE WIDTH=510 BORDER=2 CELLSPACING=1 CELLPADDING=1>\n");
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
-   fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=8>"         \
+   fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=12>"         \
            "%s %d %s %d %s</TH></TR>\n",
            GREY,msg_top_top,tot_num,msg_top_of,tot_ctry,msg_top_c);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
@@ -2075,6 +2209,10 @@
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",LTBLUE,msg_h_files);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"             \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",RED,msg_h_xfer);
+   fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"             \
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",LTBLUE,msg_h_ixfer);
+   fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"             \
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",GREEN,msg_h_oxfer);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center>"                       \
           "<FONT SIZE=\"-1\">%s</FONT></TH></TR>\n",CYAN,msg_h_ctry);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
@@ -2089,6 +2227,10 @@
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
               "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
               "<TD ALIGN=left NOWRAP><FONT SIZE=\"-1\">%s</FONT></TD></TR>\n",
               i+1,top_ctrys[i]->count,
               (t_hit==0)?0:((float)top_ctrys[i]->count/t_hit)*100.0,
@@ -2096,6 +2238,10 @@
               (t_file==0)?0:((float)top_ctrys[i]->files/t_file)*100.0,
               top_ctrys[i]->xfer/1024,
               (t_xfer==0)?0:((float)top_ctrys[i]->xfer/t_xfer)*100.0,
+              top_ctrys[i]->ixfer/1024,
+              (t_ixfer==0)?0:((float)top_ctrys[i]->ixfer/t_ixfer)*100.0,
+              top_ctrys[i]->oxfer/1024,
+              (t_oxfer==0)?0:((float)top_ctrys[i]->oxfer/t_oxfer)*100.0,
               top_ctrys[i]->desc);
    }
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
@@ -2123,8 +2269,9 @@
    /* need a header? */
    if (dump_header)
    {
-      fprintf(out_fp,"%s\t%s\t%s\t%s\t%s\n",
-       msg_h_hits,msg_h_files,msg_h_xfer,msg_h_visits,msg_h_hname);
+      fprintf(out_fp,"%s\t%s\t%s\t%s\t%s\t%s\t%s\n",
+       msg_h_hits,msg_h_files,msg_h_xfer,msg_h_ixfer,msg_h_oxfer,msg_h_visits,
+       msg_h_hname);
    }

    /* dump 'em */
@@ -2135,8 +2282,9 @@
       if (hptr->flag != OBJ_GRP)
       {
          fprintf(out_fp,
-         "%lld\t%lld\t%.0f\t%lld\t%s\n",
+         "%lld\t%lld\t%.0f\t%.0f\t%.0f\t%lld\t%s\n",
             hptr->count,hptr->files,hptr->xfer/1024,
+            hptr->ixfer/1024,hptr->oxfer/1024,
             hptr->visit,hptr->string);
       }
       cnt--;
@@ -2166,7 +2314,8 @@
    /* need a header? */
    if (dump_header)
    {
-      fprintf(out_fp,"%s\t%s\t%s\n",msg_h_hits,msg_h_xfer,msg_h_url);
+      fprintf(out_fp,"%s\t%s\t%s\t%s\t%s\n",msg_h_hits,msg_h_xfer,msg_h_ixfer,
+                      msg_h_oxfer,msg_h_url);
    }

    /* dump 'em */
@@ -2176,8 +2325,9 @@
       uptr=*pointer++;
       if (uptr->flag != OBJ_GRP)
       {
-         fprintf(out_fp,"%lld\t%.0f\t%s\n",
-            uptr->count,uptr->xfer/1024,uptr->string);
+         fprintf(out_fp,"%lld\t%.0f\t%.0f\t%.0f\t%s\n",
+            uptr->count,uptr->xfer/1024,uptr->ixfer/1024,uptr->oxfer/1024,
+            uptr->string);
       }
       cnt--;
    }
@@ -2284,8 +2434,9 @@
    /* need a header? */
    if (dump_header)
    {
-      fprintf(out_fp,"%s\t%s\t%s\t%s\t%s\n",
-         msg_h_hits,msg_h_files,msg_h_xfer,msg_h_visits,msg_h_uname);
+      fprintf(out_fp,"%s\t%s\t%s\t%s\t%s\t%s\t%s\n",
+         msg_h_hits,msg_h_files,msg_h_xfer,msg_h_ixfer,msg_h_oxfer,msg_h_visits,
+         msg_h_uname);
    }

    /* dump 'em */
@@ -2296,8 +2447,9 @@
       if (iptr->flag != OBJ_GRP)
       {
          fprintf(out_fp,
-         "%lld\t%lld\t%.0f\t%lld\t%s\n",
+         "%lld\t%lld\t%.0f\t%.0f\t%.0f\t%lld\t%s\n",
             iptr->count,iptr->files,iptr->xfer/1024,
+            iptr->ixfer/1024,iptr->oxfer/1024,
             iptr->visit,iptr->string);
       }
       cnt--;
@@ -2357,6 +2509,8 @@
    u_int64_t  gt_files=0;
    u_int64_t  gt_pages=0;
    u_int64_t  gt_xfer=0;
+   u_int64_t  gt_ixfer=0;
+   u_int64_t  gt_oxfer=0;
    u_int64_t  gt_visits=0;
    char    index_fname[256];
    char    buffer[BUFSIZE];
@@ -2387,8 +2541,10 @@
                    hist_files,          /* data set 2        */
                    hist_site,           /* data set 3        */
                    hist_xfer,           /* data set 4        */
-                   hist_page,           /* data set 5        */
-                   hist_visit);         /* data set 6        */
+                   hist_ixfer,          /* data set 5        */
+                   hist_oxfer,          /* data set 6        */
+                   hist_page,           /* data set 7        */
+                   hist_visit);         /* data set 8        */

    /* now do html stuff... */
    sprintf(index_fname,"index.%s",html_ext);
@@ -2406,14 +2562,14 @@
    /* month table */
    fprintf(out_fp,"<TABLE WIDTH=600 BORDER=2 CELLSPACING=1 CELLPADDING=1>\n");
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
-   fprintf(out_fp,"<TR><TH COLSPAN=11 BGCOLOR=\"%s\" ALIGN=center>",GREY);
+   fprintf(out_fp,"<TR><TH COLSPAN=13 BGCOLOR=\"%s\" ALIGN=center>",GREY);
    fprintf(out_fp,"%s</TH></TR>\n",msg_main_sum);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"<TR><TH ALIGN=left ROWSPAN=2 BGCOLOR=\"%s\">"          \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",GREY,msg_h_mth);
    fprintf(out_fp,"<TH ALIGN=center COLSPAN=4 BGCOLOR=\"%s\">"            \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",GREY,msg_main_da);
-   fprintf(out_fp,"<TH ALIGN=center COLSPAN=6 BGCOLOR=\"%s\">"            \
+   fprintf(out_fp,"<TH ALIGN=center COLSPAN=8 BGCOLOR=\"%s\">"            \
           "<FONT SIZE=\"-1\">%s</FONT></TH></TR>\n",GREY,msg_main_mt);
    fprintf(out_fp,"<TR><TH ALIGN=center BGCOLOR=\"%s\">"                  \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",DKGREEN,msg_h_hits);
@@ -2428,6 +2584,10 @@
    fprintf(out_fp,"<TH ALIGN=center BGCOLOR=\"%s\">"                      \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",RED,msg_h_xfer);
    fprintf(out_fp,"<TH ALIGN=center BGCOLOR=\"%s\">"                      \
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",LTBLUE,msg_h_ixfer);
+   fprintf(out_fp,"<TH ALIGN=center BGCOLOR=\"%s\">"                      \
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",GREEN,msg_h_oxfer);
+   fprintf(out_fp,"<TH ALIGN=center BGCOLOR=\"%s\">"                      \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",YELLOW,msg_h_visits);
    fprintf(out_fp,"<TH ALIGN=center BGCOLOR=\"%s\">"                      \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",CYAN,msg_h_pages);
@@ -2459,6 +2619,10 @@
                       hist_site[s_mth]);
       fprintf(out_fp,"<TD ALIGN=right><FONT SIZE=\"-1\">%.0f</FONT></TD>\n",
                       hist_xfer[s_mth]);
+      fprintf(out_fp,"<TD ALIGN=right><FONT SIZE=\"-1\">%.0f</FONT></TD>\n",
+                      hist_ixfer[s_mth]);
+      fprintf(out_fp,"<TD ALIGN=right><FONT SIZE=\"-1\">%.0f</FONT></TD>\n",
+                      hist_oxfer[s_mth]);
       fprintf(out_fp,"<TD ALIGN=right><FONT SIZE=\"-1\">%lld</FONT></TD>\n",
                       hist_visit[s_mth]);
       fprintf(out_fp,"<TD ALIGN=right><FONT SIZE=\"-1\">%lld</FONT></TD>\n",
@@ -2471,6 +2635,8 @@
       gt_files += hist_files[s_mth];
       gt_pages += hist_page[s_mth];
       gt_xfer  += hist_xfer[s_mth];
+      gt_ixfer += hist_ixfer[s_mth];
+      gt_oxfer += hist_oxfer[s_mth];
       gt_visits+= hist_visit[s_mth];
       /* remember the oldest month we processed */
       earliest_month = hist_month[s_mth];
@@ -2650,6 +2816,10 @@
     fprintf(out_fp,"<TD BGCOLOR=\"%s\" ALIGN=right>"                       \
	  "<FONT SIZE=\"-1\"><B>%lld</B></FONT></TD>\n",GREY,gt_xfer);
     fprintf(out_fp,"<TD BGCOLOR=\"%s\" ALIGN=right>"                       \
+           "<FONT SIZE=\"-1\">%lld</FONT></TH>\n",GREY,gt_ixfer);
+    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=right>"                       \
+           "<FONT SIZE=\"-1\">%lld</FONT></TH>\n",GREY,gt_oxfer);
+    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=right>"                       \
	  "<FONT SIZE=\"-1\"><B>%lld</B></FONT></TD>\n",GREY,gt_visits);
     fprintf(out_fp,"<TD BGCOLOR=\"%s\" ALIGN=right>"                       \
	  "<FONT SIZE=\"-1\"><B>%lld</B></FONT></TD>\n",GREY,gt_pages);
diff -urNad webalizer-2.01.10~/parser.c webalizer-2.01.10/parser.c
--- webalizer-2.01.10~/parser.c	2001-06-15 05:34:24.000000000 -0300
+++ webalizer-2.01.10/parser.c	2006-05-24 19:05:12.000000000 -0300
@@ -210,6 +210,9 @@
    /* return appropriate response code */
    log_rec.resp_code=(*(eob-2)=='i')?206:200;

+   /* don't worry about I/O bytes in FTP */
+   log_rec.ixfer_size=log_rec.oxfer_size=0;
+
    return 1;
 }

@@ -369,6 +372,18 @@
    while ( (*cp1 != '\0') && (cp1 != eos) ) *cp2++ = *cp1++;
    *cp2 = '\0';

+   /* IN xfer size */
+   while ( (*cp1 != '\0') && (cp1 < eob) ) cp1++;
+   if (cp1 < eob) cp1++;
+   if (*cp1<'0'||*cp1>'9') log_rec.ixfer_size=0;
+   else log_rec.ixfer_size = strtoul(cp1,NULL,10);
+
+   /* OUT xfer size */
+   while ( (*cp1 != '\0') && (cp1 < eob) ) cp1++;
+   if (cp1 < eob) cp1++;
+   if (*cp1<'0'||*cp1>'9') log_rec.oxfer_size=0;
+   else log_rec.oxfer_size = strtoul(cp1,NULL,10);
+
    return 1;     /* maybe a valid record, return with TRUE */
 }

@@ -497,6 +512,9 @@
    /* strip trailing space(s) */
    while (*cp2==' ') *cp2--='\0';

+   /* don't do this for squid */
+   log_rec.ixfer_size=log_rec.oxfer_size=0;
+
    /* we have no interest in the remaining fields */
    return 1;
 }
diff -urNad webalizer-2.01.10~/preserve.c webalizer-2.01.10/preserve.c
--- webalizer-2.01.10~/preserve.c	2006-05-24 19:05:11.000000000 -0300
+++ webalizer-2.01.10/preserve.c	2006-05-24 19:05:12.000000000 -0300
@@ -71,6 +71,8 @@
 u_int64_t  hist_files[12];                       /* produce index.html       */
 u_int64_t  hist_site[12];                        /* these are read and saved */
 double  hist_xfer[12];                        /* in the history file      */
+double  hist_ixfer[12];                       /* in the history file      */
+double  hist_oxfer[12];                       /* in the history file      */
 u_int64_t  hist_page[12];
 u_int64_t  hist_visit[12];

@@ -91,7 +93,7 @@
    {
       hist_month[i]=hist_year[i]=hist_fday[i]=hist_lday[i]=0;
       hist_hit[i]=hist_files[i]=hist_site[i]=hist_page[i]=hist_visit[i]=0;
-      hist_xfer[i]=0.0;
+      hist_xfer[i]=hist_ixfer[i]=hist_oxfer[i]=0.0;
    }

    hist_fp=fopen(hist_fname,"r");
@@ -110,7 +112,8 @@
          }

          /* month# year# requests files sites xfer firstday lastday */
-         numfields = sscanf(buffer,"%d %d %lld %lld %lld %lf %d %d %lld %lld",
+         numfields = sscanf(buffer,
+                       "%d %d %lld %lld %lld %lf %d %d %lld %lld %lf %lf",
                        &hist_month[i],
                        &hist_year[i],
                        &hist_hit[i],
@@ -120,7 +123,9 @@
                        &hist_fday[i],
                        &hist_lday[i],
                        &hist_page[i],
-                       &hist_visit[i]);
+                       &hist_visit[i],
+                       &hist_ixfer[i],
+                       &hist_oxfer[i]);

          if (numfields==8)     /* kludge for reading 1.20.xx history files */
          {
@@ -151,7 +156,7 @@
       {
          if ((hist_month[i] != 0) && (hist_hit[i] != 0))
          {
-            fprintf(hist_fp,"%d %d %lld %lld %lld %.0f %d %d %lld %lld\n",
+            fprintf(hist_fp,"%d %d %lld %lld %lld %.0f %d %d %lld %lld %.0f %.0f\n",
                             hist_month[i],
                             hist_year[i],
                             hist_hit[i],
@@ -161,7 +166,9 @@
                             hist_fday[i],
                             hist_lday[i],
                             hist_page[i],
-                            hist_visit[i]);
+                            hist_visit[i],
+                            hist_ixfer[i],
+                            hist_oxfer[i]);
          }
       }
       fclose(hist_fp);
@@ -214,9 +221,9 @@
    if (fputs(buffer,fp)==EOF) return 1;  /* error exit */

    /* Monthly totals for sites, urls, etc... */
-   sprintf(buffer,"%lld %lld %lld %lld %lld %lld %.0f %lld %lld %lld\n",
+   sprintf(buffer,"%lld %lld %lld %lld %lld %lld %.0f %lld %lld %lld %.0f %.0f\n",
         t_hit, t_file, t_site, t_url,
-        t_ref, t_agent, t_xfer, t_page, t_visit, t_user);
+        t_ref, t_agent, t_xfer, t_page, t_visit, t_user, t_ixfer, t_oxfer);
    if (fputs(buffer,fp)==EOF) return 1;  /* error exit */

    /* Daily totals for sites, urls, etc... */
@@ -227,16 +234,17 @@
    /* Monthly (by day) total array */
    for (i=0;i<31;i++)
    {
-      sprintf(buffer,"%lld %lld %.0f %lld %lld %lld\n",
-        tm_hit[i],tm_file[i],tm_xfer[i],tm_site[i],tm_page[i],tm_visit[i]);
+      sprintf(buffer,"%lld %lld %.0f %lld %lld %lld %.0f %.0f\n",
+        tm_hit[i],tm_file[i],tm_xfer[i],tm_site[i],
+        tm_page[i],tm_visit[i],tm_ixfer[i],tm_oxfer[i]);
       if (fputs(buffer,fp)==EOF) return 1;  /* error exit */
    }

    /* Daily (by hour) total array */
    for (i=0;i<24;i++)
    {
-      sprintf(buffer,"%lld %lld %.0f %lld\n",
-        th_hit[i],th_file[i],th_xfer[i],th_page[i]);
+      sprintf(buffer,"%lld %lld %.0f %lld %.0f %.0f\n",
+        th_hit[i],th_file[i],th_xfer[i],th_page[i],th_ixfer[i],th_oxfer[i]);
       if (fputs(buffer,fp)==EOF) return 1;  /* error exit */
    }

@@ -255,9 +263,9 @@
       uptr=um_htab[i];
       while (uptr!=NULL)
       {
-         sprintf(buffer,"%s\n%d %lld %lld %.0f %lld %lld\n", uptr->string,
+         sprintf(buffer,"%s\n%d %lld %lld %.0f %lld %lld %.0f %.0f\n", uptr->string,
               uptr->flag, uptr->count, uptr->files, uptr->xfer,
-              uptr->entry, uptr->exit);
+              uptr->entry, uptr->exit,uptr->ixfer, uptr->oxfer);
          if (fputs(buffer,fp)==EOF) return 1;
          uptr=uptr->next;
       }
@@ -272,7 +280,7 @@
       hptr=sm_htab[i];
       while (hptr!=NULL)
       {
-         sprintf(buffer,"%s\n%d %lld %lld %.0f %lld %lld\n%s\n",
+         sprintf(buffer,"%s\n%d %lld %lld %.0f %lld %lld\n%s %.0f %.0f\n",
               hptr->string,
               hptr->flag,
               hptr->count,
@@ -280,7 +288,9 @@
               hptr->xfer,
               hptr->visit,
               hptr->tstamp,
-              (hptr->lasturl==blank_str)?"-":hptr->lasturl);
+              (hptr->lasturl==blank_str)?"-":hptr->lasturl,
+              hptr->ixfer,
+              hptr->oxfer);
          if (fputs(buffer,fp)==EOF) return 1;  /* error exit */
          hptr=hptr->next;
       }
@@ -294,7 +304,7 @@
       hptr=sd_htab[i];
       while (hptr!=NULL)
       {
-         sprintf(buffer,"%s\n%d %lld %lld %.0f %lld %lld\n%s\n",
+         sprintf(buffer,"%s\n%d %lld %lld %.0f %lld %lld\n%s %.0f %.0f\n",
               hptr->string,
               hptr->flag,
               hptr->count,
@@ -302,7 +312,9 @@
               hptr->xfer,
               hptr->visit,
               hptr->tstamp,
-              (hptr->lasturl==blank_str)?"-":hptr->lasturl);
+              (hptr->lasturl==blank_str)?"-":hptr->lasturl,
+              hptr->ixfer,
+              hptr->oxfer);
          if (fputs(buffer,fp)==EOF) return 1;
          hptr=hptr->next;
       }
@@ -367,14 +379,16 @@
       iptr=im_htab[i];
       while (iptr!=NULL)
       {
-         sprintf(buffer,"%s\n%d %lld %lld %.0f %lld %lld\n",
+         sprintf(buffer,"%s\n%d %lld %lld %.0f %lld %lld %.0f %.0f\n",
               iptr->string,
               iptr->flag,
               iptr->count,
               iptr->files,
               iptr->xfer,
               iptr->visit,
-              iptr->tstamp);
+              iptr->tstamp,
+              iptr->ixfer,
+              iptr->oxfer);
          if (fputs(buffer,fp)==EOF) return 1;  /* error exit */
          iptr=iptr->next;
       }
@@ -437,9 +451,10 @@
    /* Get monthly totals */
    if ((fgets(buffer,BUFSIZE,fp)) != NULL)
    {
-      sscanf(buffer,"%lld %lld %lld %lld %lld %lld %lf %lld %lld %lld",
+      sscanf(buffer,"%lld %lld %lld %lld %lld %lld %lf %lld %lld %lld %lf %lf",
        &t_hit, &t_file, &t_site, &t_url,
-       &t_ref, &t_agent, &t_xfer, &t_page, &t_visit, &t_user);
+       &t_ref, &t_agent, &t_xfer, &t_page, &t_visit,
+       &t_user, &t_ixfer, &t_oxfer);
    } else return 3;  /* error exit */

    /* Get daily totals */
@@ -454,9 +469,9 @@
    {
       if ((fgets(buffer,BUFSIZE,fp)) != NULL)
       {
-         sscanf(buffer,"%lld %lld %lf %lld %lld %lld",
-          &tm_hit[i],&tm_file[i],&tm_xfer[i],&tm_site[i],&tm_page[i],
-          &tm_visit[i]);
+         sscanf(buffer,"%lld %lld %lf %lld %lld %lld %lf %lf",
+          &tm_hit[i],&tm_file[i],&tm_xfer[i],
+          &tm_site[i],&tm_page[i],&tm_visit[i],&tm_ixfer[i],&tm_oxfer[i]);
       } else return 5;  /* error exit */
    }

@@ -465,8 +480,9 @@
    {
       if ((fgets(buffer,BUFSIZE,fp)) != NULL)
       {
-         sscanf(buffer,"%lld %lld %lf %lld",
-          &th_hit[i],&th_file[i],&th_xfer[i],&th_page[i]);
+         sscanf(buffer,"%lld %lld %lf %lld %lf %lf",
+          &th_hit[i],&th_file[i],&th_xfer[i],
+          &th_page[i],&th_ixfer[i],&th_oxfer[i]);
       } else return 6;  /* error exit */
    }

@@ -500,14 +516,15 @@
       if (!isdigit((int)buffer[0])) return 10;  /* error exit */

       /* load temporary node data */
-      sscanf(buffer,"%d %lld %lld %lf %lld %lld",
+      sscanf(buffer,"%d %lld %lld %lf %lld %lld %lf %lf",
          &t_unode.flag,&t_unode.count,
          &t_unode.files, &t_unode.xfer,
-         &t_unode.entry, &t_unode.exit);
+         &t_unode.entry, &t_unode.exit, &t_unode.ixfer, &t_unode.oxfer);

       /* Good record, insert into hash table */
       if (put_unode(tmp_buf,t_unode.flag,t_unode.count,
-         t_unode.xfer,&ul_bogus,t_unode.entry,t_unode.exit,um_htab))
+         t_unode.xfer,t_unode.ixfer,t_unode.oxfer,&ul_bogus,t_unode.entry,
+         t_unode.exit,um_htab))
       {
          if (verbose)
          /* Error adding URL node, skipping ... */
@@ -531,10 +548,10 @@
       if (!isdigit((int)buffer[0])) return 8;  /* error exit */

       /* load temporary node data */
-      sscanf(buffer,"%d %lld %lld %lf %lld %lld",
+      sscanf(buffer,"%d %lld %lld %lf %lld %lld %lf %lf",
          &t_hnode.flag,&t_hnode.count,
          &t_hnode.files, &t_hnode.xfer,
-         &t_hnode.visit, &t_hnode.tstamp);
+         &t_hnode.visit, &t_hnode.tstamp, &t_hnode.ixfer, &t_hnode.oxfer);

       /* get last url */
       if ((fgets(buffer,BUFSIZE,fp)) == NULL) return 8;  /* error exit */
@@ -547,7 +564,8 @@

       /* Good record, insert into hash table */
       if (put_hnode(tmp_buf,t_hnode.flag,
-         t_hnode.count,t_hnode.files,t_hnode.xfer,&ul_bogus,
+         t_hnode.count,t_hnode.files,t_hnode.xfer,t_hnode.ixfer,t_hnode.oxfer,
+         &ul_bogus,
          t_hnode.visit+1,t_hnode.tstamp,t_hnode.lasturl,sm_htab))
       {
          /* Error adding host node (monthly), skipping .... */
@@ -571,10 +589,10 @@
       if (!isdigit((int)buffer[0])) return 9;  /* error exit */

       /* load temporary node data */
-      sscanf(buffer,"%d %lld %lld %lf %lld %lld",
+      sscanf(buffer,"%d %lld %lld %lf %lld %lld %lf %lf",
           &t_hnode.flag,&t_hnode.count,
           &t_hnode.files, &t_hnode.xfer,
-          &t_hnode.visit, &t_hnode.tstamp);
+          &t_hnode.visit, &t_hnode.tstamp, &t_hnode.ixfer, &t_hnode.oxfer);

       /* get last url */
       if ((fgets(buffer,BUFSIZE,fp)) == NULL) return 9;  /* error exit */
@@ -587,7 +605,8 @@

       /* Good record, insert into hash table */
       if (put_hnode(tmp_buf,t_hnode.flag,
-         t_hnode.count,t_hnode.files,t_hnode.xfer,&ul_bogus,
+         t_hnode.count,t_hnode.files,t_hnode.xfer,t_hnode.ixfer,t_hnode.oxfer,
+         &ul_bogus,
          t_hnode.visit+1,t_hnode.tstamp,t_hnode.lasturl,sd_htab))
       {
          /* Error adding host node (daily), skipping .... */
@@ -685,14 +704,15 @@
       if (!isdigit((int)buffer[0])) return 14;  /* error exit */

       /* load temporary node data */
-      sscanf(buffer,"%d %lld %lld %lf %lld %lld",
+      sscanf(buffer,"%d %lld %lld %lf %lld %lld %lf %lf",
          &t_inode.flag,&t_inode.count,
          &t_inode.files, &t_inode.xfer,
-         &t_inode.visit, &t_inode.tstamp);
+         &t_inode.visit, &t_inode.tstamp, &t_inode.ixfer, &t_inode.oxfer);

       /* Good record, insert into hash table */
       if (put_inode(tmp_buf,t_inode.flag,
-         t_inode.count,t_inode.files,t_inode.xfer,&ul_bogus,
+         t_inode.count,t_inode.files,t_inode.xfer,t_inode.ixfer,t_inode.oxfer,
+         &ul_bogus,
          t_inode.visit+1,t_inode.tstamp,im_htab))
       {
          if (verbose)
diff -urNad webalizer-2.01.10~/preserve.h webalizer-2.01.10/preserve.h
--- webalizer-2.01.10~/preserve.h	2006-05-24 19:05:11.000000000 -0300
+++ webalizer-2.01.10/preserve.h	2006-05-24 19:05:12.000000000 -0300
@@ -12,6 +12,8 @@
 extern u_int64_t  hist_files[12];             /* produce index.html       */
 extern u_int64_t  hist_site[12];              /* these are read and saved */
 extern double  hist_xfer[12];                 /* in the history file      */
+extern double  hist_ixfer[12];                /* in the history file      */
+extern double  hist_oxfer[12];                /* in the history file      */
 extern u_int64_t  hist_page[12];
 extern u_int64_t  hist_visit[12];

diff -urNad webalizer-2.01.10~/webalizer.c webalizer-2.01.10/webalizer.c
--- webalizer-2.01.10~/webalizer.c	2006-05-24 19:05:11.000000000 -0300
+++ webalizer-2.01.10/webalizer.c	2006-05-24 19:05:12.000000000 -0300
@@ -191,11 +191,15 @@
 int     gz_log=0;                             /* gziped log? (0=no)       */

 double  t_xfer=0.0;                           /* monthly total xfer value */
+double  t_ixfer=0.0;                          /* monthly total in xfer    */
+double  t_oxfer=0.0;                          /* monthly total out xfer   */
 u_int64_t  t_hit=0,t_file=0,t_site=0,            /* monthly total vars       */
         t_url=0,t_ref=0,t_agent=0,
         t_page=0, t_visit=0, t_user=0;

 double  tm_xfer[31];                          /* daily transfer totals    */
+double  tm_ixfer[31];                         /* daily in xfer totals     */
+double  tm_oxfer[31];                         /* daily out xfer totals    */

 u_int64_t  tm_hit[31], tm_file[31],              /* daily total arrays       */
         tm_site[31], tm_page[31],
@@ -209,6 +213,8 @@
         th_page[24];

 double  th_xfer[24];
+double  th_ixfer[24];
+double  th_oxfer[24];

 int     f_day,l_day;                          /* first/last day vars      */

@@ -1126,7 +1132,8 @@
          {
             /* URL hash table */
             if (put_unode(log_rec.url,OBJ_REG,(u_int64_t)1,
-                log_rec.xfer_size,&t_url,(u_int64_t)0,(u_int64_t)0,um_htab))
+                log_rec.xfer_size,log_rec.ixfer_size,log_rec.oxfer_size,
+                &t_url,(u_int64_t)0,(u_int64_t)0,um_htab))
             {
                if (verbose)
                /* Error adding URL node, skipping ... */
@@ -1135,7 +1142,8 @@

             /* ident (username) hash table */
             if (put_inode(log_rec.ident,OBJ_REG,
-                1,(u_int64_t)i,log_rec.xfer_size,&t_user,
+                1,(u_int64_t)i,log_rec.xfer_size,
+                log_rec.ixfer_size,log_rec.oxfer_size,&t_user,
                 0,rec_tstamp,im_htab))
             {
                if (verbose)
@@ -1157,7 +1165,8 @@

          /* hostname (site) hash table - daily */
          if (put_hnode(log_rec.hostname,OBJ_REG,
-             1,(u_int64_t)i,log_rec.xfer_size,&dt_site,
+             1,(u_int64_t)i,log_rec.xfer_size,
+             log_rec.ixfer_size,log_rec.oxfer_size,&dt_site,
              0,rec_tstamp,"",sd_htab))
          {
             if (verbose)
@@ -1167,7 +1176,8 @@

          /* hostname (site) hash table - monthly */
          if (put_hnode(log_rec.hostname,OBJ_REG,
-             1,(u_int64_t)i,log_rec.xfer_size,&t_site,
+             1,(u_int64_t)i,log_rec.xfer_size,
+             log_rec.ixfer_size,log_rec.oxfer_size,&t_site,
              0,rec_tstamp,"",sm_htab))
          {
             if (verbose)
@@ -1188,10 +1198,16 @@

          /* bump monthly/daily/hourly totals        */
          t_hit++; ht_hit++;                         /* daily/hourly hits    */
-         t_xfer += log_rec.xfer_size;               /* total xfer size      */
-         tm_xfer[rec_day-1] += log_rec.xfer_size;   /* daily xfer total     */
+         t_xfer  += log_rec.xfer_size;              /* total xfer size      */
+         t_ixfer += log_rec.ixfer_size;             /* total in xfer size   */
+         t_oxfer += log_rec.oxfer_size;             /* total out xfer size  */
+         tm_xfer[rec_day-1]  += log_rec.xfer_size;  /* daily xfer total     */
+         tm_ixfer[rec_day-1] += log_rec.ixfer_size; /* daily in xfer total  */
+         tm_oxfer[rec_day-1] += log_rec.oxfer_size; /* daily out xfer total */
          tm_hit[rec_day-1]++;                       /* daily hits total     */
          th_xfer[rec_hour] += log_rec.xfer_size;    /* hourly xfer total    */
+         th_ixfer[rec_hour] += log_rec.ixfer_size;  /* hourly in xfer total */
+         th_oxfer[rec_hour] += log_rec.oxfer_size;  /* hourly out xfer total*/
          th_hit[rec_hour]++;                        /* hourly hits total    */

          /* if RC_OK, increase file counters */
@@ -1221,6 +1237,7 @@
          if ( (cp1=isinglist(group_urls,log_rec.url))!=NULL)
          {
             if (put_unode(cp1,OBJ_GRP,(u_int64_t)1,log_rec.xfer_size,
+                log_rec.ixfer_size,log_rec.oxfer_size,
                 &ul_bogus,(u_int64_t)0,(u_int64_t)0,um_htab))
             {
                if (verbose)
@@ -1233,7 +1250,8 @@
          if ( (cp1=isinglist(group_sites,log_rec.hostname))!=NULL)
          {
             if (put_hnode(cp1,OBJ_GRP,1,(u_int64_t)(log_rec.resp_code==RC_OK)?1:0,
-                          log_rec.xfer_size,&ul_bogus,
+                          log_rec.xfer_size,
+                          log_rec.ixfer_size,log_rec.oxfer_size,&ul_bogus,
                           0,rec_tstamp,"",sm_htab))
             {
                if (verbose)
@@ -1251,8 +1269,8 @@
                {
                   if (put_hnode(cp1,OBJ_GRP,1,
                       (u_int64_t)(log_rec.resp_code==RC_OK)?1:0,
-                      log_rec.xfer_size,&ul_bogus,
-                      0,rec_tstamp,"",sm_htab))
+                      log_rec.xfer_size,log_rec.ixfer_size,log_rec.oxfer_size,
+                      &ul_bogus,0,rec_tstamp,"",sm_htab))
                   {
                      if (verbose)
                      /* Error adding Site node, skipping ... */
@@ -1288,7 +1306,8 @@
          if ( (cp1=isinglist(group_users,log_rec.ident))!=NULL)
          {
             if (put_inode(cp1,OBJ_GRP,1,(u_int64_t)(log_rec.resp_code==RC_OK)?1:0,
-                          log_rec.xfer_size,&ul_bogus,
+                          log_rec.xfer_size,
+                          log_rec.ixfer_size,log_rec.oxfer_size,&ul_bogus,
                           0,rec_tstamp,im_htab))
             {
                if (verbose)
@@ -1689,22 +1708,22 @@
    for (i=0;i<TOTAL_RC;i++) response[i].count = 0;
    for (i=0;i<31;i++)  /* monthly totals      */
    {
-    tm_xfer[i]=0.0;
+    tm_xfer[i]=tm_ixfer[i]=tm_oxfer[i]=0.0;
     tm_hit[i]=tm_file[i]=tm_site[i]=tm_page[i]=tm_visit[i]=0;
    }
    for (i=0;i<24;i++)  /* hourly totals       */
    {
       th_hit[i]=th_file[i]=th_page[i]=0;
-      th_xfer[i]=0.0;
+      th_xfer[i]=th_ixfer[i]=th_oxfer[i]=0.0;
    }
    for (i=0;ctry[i].desc;i++) /* country totals */
    {
       ctry[i].count=0;
       ctry[i].files=0;
-      ctry[i].xfer=0;
+      ctry[i].xfer=ctry[i].ixfer=ctry[i].oxfer=0;
    }
    t_hit=t_file=t_site=t_url=t_ref=t_agent=t_page=t_visit=t_user=0;
-   t_xfer=0.0;
+   t_xfer=t_ixfer=t_oxfer=0.0;
    mh_hit = dt_site = 0;
    f_day=l_day=1;
 }
diff -urNad webalizer-2.01.10~/webalizer.h webalizer-2.01.10/webalizer.h
--- webalizer-2.01.10~/webalizer.h	2006-05-24 19:05:11.000000000 -0300
+++ webalizer-2.01.10/webalizer.h	2006-05-24 19:05:12.000000000 -0300
@@ -136,7 +136,9 @@
                          char *desc;
                        u_int64_t count;
                        u_int64_t files;
-                       double  xfer; };
+                       double  xfer;
+                       double  ixfer;
+                       double  oxfer; };

 typedef struct country_code *CLISTPTR;

@@ -146,6 +148,8 @@
                        char   url[MAXURL];         /* raw request field    */
                        int    resp_code;           /* response code        */
                        u_int64_t xfer_size;           /* xfer size in bytes   */
+                       u_int64_t ixfer_size;          /* in xfer size bytes   */
+                       u_int64_t oxfer_size;          /* out xfer size bytes  */
 #ifdef USE_DNS
                        struct in_addr addr;        /* IP address structure */
 #endif  /* USE_DNS */
@@ -237,11 +241,15 @@
                cur_min, cur_sec;

 extern double  t_xfer;                        /* monthly total xfer value */
+extern double  t_ixfer;                       /* monthly total in xfer    */
+extern double  t_oxfer;                       /* monthly total out xfer   */
 extern u_int64_t  t_hit, t_file, t_site,         /* monthly total vars       */
                t_url, t_ref,  t_agent,
                t_page,t_visit,t_user;

 extern double  tm_xfer[31];                   /* daily transfer totals    */
+extern double  tm_ixfer[31];                  /* daily in xfer totals     */
+extern double  tm_oxfer[31];                  /* daily out xfer totals    */

 extern u_int64_t  tm_hit[31], tm_file[31],       /* daily total arrays       */
                tm_site[31],tm_page[31],
@@ -255,6 +263,8 @@
                th_page[24];

 extern double  th_xfer[24];
+extern double  th_ixfer[24];
+extern double  th_oxfer[24];

 extern int     f_day,l_day;                   /* first/last day vars      */
 extern int     gz_log;                        /* flag for zipped log      */
